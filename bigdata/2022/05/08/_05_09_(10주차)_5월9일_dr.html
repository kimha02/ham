<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>(10주차) 5월4일 | Hayoung Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="(10주차) 5월4일" />
<meta name="author" content="최규빈" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="작업환경, softmax, 평가지표, DNN과 fashion MNIST" />
<meta property="og:description" content="작업환경, softmax, 평가지표, DNN과 fashion MNIST" />
<link rel="canonical" href="https://kimha02.github.io/ham/bigdata/2022/05/08/_05_09_(10%EC%A3%BC%EC%B0%A8)_5%EC%9B%949%EC%9D%BC_dr.html" />
<meta property="og:url" content="https://kimha02.github.io/ham/bigdata/2022/05/08/_05_09_(10%EC%A3%BC%EC%B0%A8)_5%EC%9B%949%EC%9D%BC_dr.html" />
<meta property="og:site_name" content="Hayoung Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-08T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2022-05-08T00:00:00-05:00","url":"https://kimha02.github.io/ham/bigdata/2022/05/08/_05_09_(10%EC%A3%BC%EC%B0%A8)_5%EC%9B%949%EC%9D%BC_dr.html","@type":"BlogPosting","headline":"(10주차) 5월4일","dateModified":"2022-05-08T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kimha02.github.io/ham/bigdata/2022/05/08/_05_09_(10%EC%A3%BC%EC%B0%A8)_5%EC%9B%949%EC%9D%BC_dr.html"},"author":{"@type":"Person","name":"최규빈"},"description":"작업환경, softmax, 평가지표, DNN과 fashion MNIST","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/ham/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://kimha02.github.io/ham/feed.xml" title="Hayoung Blog" /><link rel="shortcut icon" type="image/x-icon" href="/ham/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/ham/">Hayoung Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ham/about/">About Me</a><a class="page-link" href="/ham/search/">Search</a><a class="page-link" href="/ham/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">(10주차) 5월4일</h1><p class="page-description">작업환경, softmax, 평가지표, DNN과 fashion MNIST</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-05-08T00:00:00-05:00" itemprop="datePublished">
        May 8, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">최규빈</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      23 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/ham/categories/#Bigdata">Bigdata</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/kimha02/ham/tree/master/_notebooks/2022_05_09_(10주차)_5월9일_dr.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/ham/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/kimha02/ham/master?filepath=_notebooks%2F2022_05_09_%2810%EC%A3%BC%EC%B0%A8%29_5%EC%9B%949%EC%9D%BC_dr.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ham/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/kimha02/ham/blob/master/_notebooks/2022_05_09_(10주차)_5월9일_dr.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/ham/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#imports">imports </a></li>
<li class="toc-entry toc-h3"><a href="#로지스틱-모형-(1):-활성화함수로-sigmoid-선택">로지스틱 모형 (1): 활성화함수로 sigmoid 선택 </a></li>
<li class="toc-entry toc-h3"><a href="#로지스틱-모형-(2):-활성화함수로-softmax-선택">로지스틱 모형 (2): 활성화함수로 softmax 선택 </a></li>
<li class="toc-entry toc-h3"><a href="#sigmoid,-softmax">sigmoid, softmax </a>
<ul>
<li class="toc-entry toc-h4"><a href="#softmax는-sigmoid의-확장형">softmax는 sigmoid의 확장형 </a></li>
<li class="toc-entry toc-h4"><a href="#클래스의-수가-2인-경우-softmax-vs-sigmoid">클래스의 수가 2인 경우 softmax vs sigmoid </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#분류할-클래스가-3개-이상일-경우-신경망-모형의-설계">분류할 클래스가 3개 이상일 경우 신경망 모형의 설계 </a></li>
<li class="toc-entry toc-h3"><a href="#Fashion_MNIST-다중분류">Fashion_MNIST 다중분류 </a></li>
<li class="toc-entry toc-h2"><a href="#평가지표">평가지표 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#다양한-평가지표들">다양한 평가지표들 </a></li>
<li class="toc-entry toc-h3"><a href="#confusion-matrix의-이해">confusion matrix의 이해 </a></li>
<li class="toc-entry toc-h3"><a href="#상황극">상황극 </a></li>
<li class="toc-entry toc-h3"><a href="#Accuracy">Accuracy </a></li>
<li class="toc-entry toc-h3"><a href="#Sensitivity(민감도),-Recall(재현율),-True-Positive-Rate(TPR)">Sensitivity(민감도), Recall(재현율), True Positive Rate(TPR) </a></li>
<li class="toc-entry toc-h3"><a href="#Precision">Precision </a></li>
<li class="toc-entry toc-h3"><a href="#F1-score">F1 score </a></li>
<li class="toc-entry toc-h3"><a href="#Specificity(특이도),-False-Positive-Rate(FPR)">Specificity(특이도), False Positive Rate(FPR) </a></li>
<li class="toc-entry toc-h3"><a href="#ROC-curve">ROC curve </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#fashion_mnist-(revisit)">fashion_mnist (revisit) </a></li>
<li class="toc-entry toc-h2"><a href="#X의-차원이-(관측치수,픽셀,픽셀,채널)일-경우-DNN-쓰기">X의 차원이 (관측치수,픽셀,픽셀,채널)일 경우 DNN 쓰기 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#(예제1)-X-->-Dense(30,relu)-->-Dense(10,softmax):=>-y">(예제1) X -&gt; Dense(30,relu) -&gt; Dense(10,softmax):=&gt; y </a></li>
<li class="toc-entry toc-h3"><a href="#(예제2)-X-->-Dense(500,relu)-->-Dense(500,relu)-->-Dense(10,softmax):=>y">(예제2) X -&gt; Dense(500,relu) -&gt; Dense(500,relu) -&gt; Dense(10,softmax):=&gt;y </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#더-좋은-모형을-만들고-싶은데..">더 좋은 모형을 만들고 싶은데.. </a>
<ul>
<li class="toc-entry toc-h3"><a href="#(예제3)-아주-복잡한-DNN">(예제3) 아주 복잡한 DNN </a>
<ul>
<li class="toc-entry toc-h6"><a href="#$\to$-여기까지-05/09-수업내용">$\to$ 여기까지 05/09 수업내용 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#발상의-전환">발상의 전환 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#MaxPooling2D,-MaxPool2D">MaxPooling2D, MaxPool2D </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022_05_09_(10주차)_5월9일_dr.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>환경<br>
<code>-</code> conda env list : 환경 리스트 확인 (<code>*</code>표시가 된 것이 현재 환경)<br>
<code>-</code> conda env remove -n test : test라는 가상 환경 지우기<br>
<code>-</code> conda deactivate : base 환경으로 돌아가기<br>
<code>-</code> conda create -n test : test라는 가상환경을 만들기<br>
<code>-</code> conda activate test : test라는 가상환경에 들어가기<br>
<code>-</code> conda install -c conda-forge jupyterlab : conda는 앱스토어 느낌이라서 꼭 conda를 안해도 된다. 그런데 pip와 차이는 pip는 가장 최신버전을, conda-forge에서 추천하는 조합으로 설치할 수 있다. 그리고 이전에 설치한 패키지도 영향을 받는다.<br>
<code>-</code> conda install -c conda-forge rise : 주피터 노트북을 통해 슬라이드쇼 만들 수 있음!<br>
<code>-</code> slide는  새 슬라이드 만들기, fragment는 상위 슬라이드의 조각, 하나씩 등장</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="imports">
<a class="anchor" href="#imports" aria-hidden="true"><span class="octicon octicon-link"></span></a>imports<a class="anchor-link" href="#imports"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow.experimental.numpy</span> <span class="k">as</span> <span class="nn">tnp</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">experimental</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU'),
 PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphviz</span>
<span class="k">def</span> <span class="nf">gv</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="s1">'digraph G{ rankdir="LR"'</span><span class="o">+</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">';}'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="로지스틱-모형-(1):-활성화함수로-sigmoid-선택">
<a class="anchor" href="#%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%EB%AA%A8%ED%98%95-(1):-%ED%99%9C%EC%84%B1%ED%99%94%ED%95%A8%EC%88%98%EB%A1%9C-sigmoid-%EC%84%A0%ED%83%9D" aria-hidden="true"><span class="octicon octicon-link"></span></a>로지스틱 모형 (1): 활성화함수로 sigmoid 선택<a class="anchor-link" href="#%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%EB%AA%A8%ED%98%95-(1):-%ED%99%9C%EC%84%B1%ED%99%94%ED%95%A8%EC%88%98%EB%A1%9C-sigmoid-%EC%84%A0%ED%83%9D"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 기본버전은 아래와 같다</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
$$y_i \approx \text{sigmoid}(b + w_1 x_{1,i} + \dots + w_{784}x_{784,i})= \frac{\exp(b + w_1 x_{1,i} + \dots + w_{784}x_{784,i})}{1+\exp(b + w_1 x_{1,i} + \dots + w_{784}x_{784,i})}$$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 벡터버전은 아래와 같다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$${\boldsymbol y} \approx \text{sigmoid}({\bf X}{\bf W} + b) = \frac{\exp({\bf XW} +b)}{1+\exp({\bf XW} +b)}$$<p></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 벡터버전에 익숙해지도록 하자. 벡터버전에 사용된 차원 및 연산을 정리하면 아래와 같다.</p>
<ul>
<li>
<p>${\bf X}$: (n,784) matrix</p>
</li>
<li>
<p>${\boldsymbol y}$: (n,1) matrix</p>
</li>
<li>
<p>${\bf W}$: (784,1) matrix</p>
</li>
<li>
<p>$b$: (1,1) matrix</p>
</li>
<li>
<p><code>+</code>, <code>exp</code> 는 브로드캐스팅</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="로지스틱-모형-(2):-활성화함수로-softmax-선택">
<a class="anchor" href="#%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%EB%AA%A8%ED%98%95-(2):-%ED%99%9C%EC%84%B1%ED%99%94%ED%95%A8%EC%88%98%EB%A1%9C-softmax-%EC%84%A0%ED%83%9D" aria-hidden="true"><span class="octicon octicon-link"></span></a>로지스틱 모형 (2): 활성화함수로 softmax 선택<a class="anchor-link" href="#%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%EB%AA%A8%ED%98%95-(2):-%ED%99%9C%EC%84%B1%ED%99%94%ED%95%A8%EC%88%98%EB%A1%9C-softmax-%EC%84%A0%ED%83%9D"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> softmax는 다차원 범주로 확장하기가 편한다!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> $y_i=0 \text{ or } 1$ 대신에 $\boldsymbol{y}_i=[y_{i1},y_{i2}]= [1,0] \text { or } [0,1]$와 같이 코딩하면 어떠할까? (즉 원핫인코딩을 한다면?)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 활성화 함수를 취하기 전의 버전은 아래와 같이 볼 수 있다.</p>
<p>
$$[{\boldsymbol y}_1 ~ {\boldsymbol y}_2] \propto  [ {\bf X}{\bf W}_1  ~ {\bf X}{\bf W}_2] + [b_1 ~ b_2]= {\bf X} [{\bf W}_1 {\bf W}_2] + [b_1 ~ b_2]= {\bf X}{\bf W} + {\boldsymbol b}$$
</p>
<p>여기에서 매트릭스 및 연산의 차원을 정리하면 아래와 같다.</p>
<ul>
<li>
<p>${\bf X}$: (n,784) matrix</p>
</li>
<li>
<p>${\boldsymbol y}_1,{\boldsymbol y}_2$: (n,1) matrix</p>
</li>
<li>
<p>${\boldsymbol y}:=[{\boldsymbol y}_1~ {\boldsymbol y}_2]$: (n,2) matrix</p>
</li>
<li>
<p>${\bf W}_1$, ${\bf W}_2$: (784,1) matrix</p>
</li>
<li>
<p>${\bf W}:=[{\bf W}_1~ {\bf W}_2]$: (784,2) matrix</p>
</li>
<li>
<p>$b_1,b_2$: (1,1) matrix</p>
</li>
<li>
<p>$\boldsymbol{b}:= [b_1 ~b_2] $: (1,2) matrix</p>
</li>
<li>
<p><code>+</code> 는 브로드캐스팅</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 즉 로지스틱 모형 (1)의 형태를 <strong>겹쳐놓은</strong> 형태로 해석할 수 있음. 따라서 ${\bf X} {\bf W}_1 + b_1$와 ${\bf X} {\bf W}_2 + b_2$의 row값이 클수록 ${\boldsymbol y}_1$와 ${\boldsymbol y}_2$의 row값이 1이어야 함</p>
<ul>
<li>${\boldsymbol y}_1 \propto  {\bf X} {\bf W}_1 + b_1$ $\to$ ${\bf X} {\bf W}_1 + b_1$의 row값이 클수록 $\boldsymbol{y}_1$의 row 값이 1이라면 모형계수를 잘 추정한것 </li>
<li>${\boldsymbol y}_2 \propto  {\bf X} {\bf W}_2 + b_2$ $\to$ ${\bf X} {\bf W}_2 + b_2$의 row값이 클수록 $\boldsymbol{y}_2$의 row 값을 1이라면 모형계수를 잘 추정한것</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (문제) ${\bf X}{\bf W}_1 +b_1$의 값이 500, ${\bf X}{\bf W}_2 +b_2$의 값이 200 인 row가 있다고 하자. 대응하는 $\boldsymbol{y}_1, \boldsymbol{y}_2$의 row값은 얼마로 적합되어야 하는가?</p>
<p>(1) $[0,0]$</p>
<p>(2) $[0,1]$</p>
<p>(3) $[1,0]$ &lt;-- 이게 답이다!</p>
<p>(4) $[1,1]$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>solution:둘다 0 혹은 둘다 1로 적합할수는 없으니까 (1), (4)는 제외한다. ${\bf X}{\bf W}_1 +b_1$의 값이 ${\bf X}{\bf W}_2 +b_2$의 값보다 크므로 (3)번이 합리적임</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> <strong>목표:</strong> 위와 같은 문제의 답을 유도해주는 활성화함수를 설계하자. 즉 합리적인 $\hat{\boldsymbol{y}}_1,\hat{\boldsymbol{y}}_2$를 구해주는 활성화 함수를 설계해보자. 이를 위해서는 아래의 사항들이 충족되어야 한다.</p>
<p>(1) $\hat{\boldsymbol{y}}_1$, $\hat{\boldsymbol{y}}_2$의 각 원소는 0보다 크고 1보다 작아야 한다. (확률을 의미해야 하니까)</p>
<p>(2) $\hat{\boldsymbol{y}}_1+\hat{\boldsymbol{y}}_2={\bf 1}$ 이어야 한다. (확률의 총합은 1이니까!)</p>
<p>(3) $\hat{\boldsymbol{y}}_1$와 $\hat{\boldsymbol{y}}_2$를 각각 따로해석하면 로지스틱처럼 되면 좋겠다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 아래와 같은 활성화 함수를 도입하면 어떨까?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$\hat{\boldsymbol{y}}=[\hat{\boldsymbol y}_1 ~ \hat{\boldsymbol y}_2] =  \big[ \frac{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)}{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)+\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}  ~~ \frac{\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)+\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}  \big]$$<p></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (1),(2)는 만족하는 듯 하다. (3)은 바로 이해되지는 않는다</p>
<p>(1) $\hat{\boldsymbol{y}}_1$, $\hat{\boldsymbol{y}}_2$의 각 원소는 0보다 크고 1보다 작아야 한다. --&gt; OK!</p>
<p>(2) $\hat{\boldsymbol{y}}_1+\hat{\boldsymbol{y}}_2={\bf 1}$ 이어야 한다. --&gt; OK!</p>
<p>(3) $\hat{\boldsymbol{y}}_1$와 $\hat{\boldsymbol{y}}_2$를 각각 따로해석하면 로지스틱처럼 되면 좋겠다.  --&gt; ???</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 그런데 조금 따져보면 (3)도 만족된다는 것을 알 수 있다. (sigmoid, softmax Section 참고)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 위와 같은 함수를 softmax라고 하자. 즉 아래와 같이 정의하자.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
\hat{\boldsymbol y} = \text{softmax}({\bf X}\hat{\bf W} + {\boldsymbol b}) 
= \big[ \frac{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)}{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)+\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}  ~~ \frac{\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}{\exp({\bf X}\hat{\bf W}_1+\hat{b}_1)+\exp({\bf X}\hat{\bf W}_2+\hat{b}_2)}  \big]
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="sigmoid,-softmax">
<a class="anchor" href="#sigmoid,-softmax" aria-hidden="true"><span class="octicon octicon-link"></span></a>sigmoid, softmax<a class="anchor-link" href="#sigmoid,-softmax"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="softmax는-sigmoid의-확장형">
<a class="anchor" href="#softmax%EB%8A%94-sigmoid%EC%9D%98-%ED%99%95%EC%9E%A5%ED%98%95" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>softmax는 sigmoid의 확장형</strong><a class="anchor-link" href="#softmax%EB%8A%94-sigmoid%EC%9D%98-%ED%99%95%EC%9E%A5%ED%98%95"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 아래의 수식을 관찰하자. 

$$\frac{\exp(\beta_0+\beta_1 x_i)}{1+\exp(\beta_0+\beta_1x_i)}=\frac{\exp(\beta_0+\beta_1 x_i)}{e^0+\exp(\beta_0+\beta_1x_i)}$$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 1을 $e^0$로 해석하면 모형2의 해석을 아래와 같이 모형1의 해석으로 적용할수 있다.</p>
<ul>
<li>모형2: ${\bf X}\hat{\bf W}_1 +\hat{b}_1$ 와 ${\bf X}\hat{\bf W}_2 +\hat{b}_2$ 의 크기를 비교하고 확률 결정</li>
<li>모형1: ${\bf X}\hat{\bf W} +\hat{b}$ 와 $0$의 크기를 비교하고 확률 결정 = <strong>${\bf X}\hat{\bf W} +\hat{b}$의 row값이 양수이면 1로 예측하고 음수이면 0으로 예측</strong>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 이항분포를 차원이 2인 다항분포로 해석가능한 것처럼 sigmoid는 차원이 2인 softmax로 해석가능하다. 즉 다항분포가 이항분포의 확장형으로 해석가능한 것처럼 softmax도 sigmoid의 확장형으로 해석가능하다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="클래스의-수가-2인-경우-softmax-vs-sigmoid">
<a class="anchor" href="#%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EC%88%98%EA%B0%80-2%EC%9D%B8-%EA%B2%BD%EC%9A%B0-softmax-vs-sigmoid" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>클래스의 수가 2인 경우 softmax vs sigmoid</strong><a class="anchor-link" href="#%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EC%88%98%EA%B0%80-2%EC%9D%B8-%EA%B2%BD%EC%9A%B0-softmax-vs-sigmoid"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 언뜻 생각하면 클래스가 2인 경우에도 sigmoid 대신 softmax로 활성화함수를 이용해도 될 듯 하다. 즉 $y=0 \text{ or } 1$와 같이 정리하지 않고 $y=[0,1] \text{ or } [1,0]$ 와 같이 정리해도 무방할 듯 하다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> <strong>하지만 sigmoid가 좀 더 좋은 선택이다.</strong> 즉 $y= 0 \text{ or } 1$로 데이터를 정리하는 것이 더 좋은 선택이다. 왜냐하면 sigmoid는 softmax와 비교하여 파라메터의 수가 적지만 표현력은 동등하기 때문이다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 표현력이 동등한 이유? 아래 수식을 관찰하자.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>
$$\big(\frac{e^{300}}{e^{300}+e^{500}},\frac{e^{500}}{e^{300}+e^{500}}\big) =\big( \frac{e^{0}}{e^{0}+e^{200}}, \frac{e^{200}}{e^{0}+e^{200}}\big)$$
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>$\big(\frac{e^{300}}{e^{300}+e^{500}},\frac{e^{500}}{e^{300}+e^{500}}\big)$를 표현하기 위해서 300, 500 이라는 2개의 숫자가 필요한것이 아니고 따지고보면 <strong>200이라는 하나의 숫자만 필요하다.</strong> </li>
<li>$(\hat{\boldsymbol{y}}_1,\hat{\boldsymbol{y}}_2)$의 표현에서도 ${\bf X}\hat{\bf W}_1 +\hat{b}_1$ 와 ${\bf X}\hat{\bf W}_2 +\hat{b}_2$ 라는 숫자 각각이 필요한 것이 아니고 $({\bf X}\hat{\bf W}_1 +\hat{b}_1)-({\bf X}\hat{\bf W}_2 +\hat{b}_2)$의 값만 알면 된다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 클래스의 수가 2개일 경우는 softmax가 sigmoid에 비하여 장점이 없다. 하지만 softmax는 클래스의 수가 3개 이상일 경우로 쉽게 확장할 수 있다는 점에서 매력적인 활성화 함수이다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="분류할-클래스가-3개-이상일-경우-신경망-모형의-설계">
<a class="anchor" href="#%EB%B6%84%EB%A5%98%ED%95%A0-%ED%81%B4%EB%9E%98%EC%8A%A4%EA%B0%80-3%EA%B0%9C-%EC%9D%B4%EC%83%81%EC%9D%BC-%EA%B2%BD%EC%9A%B0-%EC%8B%A0%EA%B2%BD%EB%A7%9D-%EB%AA%A8%ED%98%95%EC%9D%98-%EC%84%A4%EA%B3%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>분류할 클래스가 3개 이상일 경우 신경망 모형의 설계<a class="anchor-link" href="#%EB%B6%84%EB%A5%98%ED%95%A0-%ED%81%B4%EB%9E%98%EC%8A%A4%EA%B0%80-3%EA%B0%9C-%EC%9D%B4%EC%83%81%EC%9D%BC-%EA%B2%BD%EC%9A%B0-%EC%8B%A0%EA%B2%BD%EB%A7%9D-%EB%AA%A8%ED%98%95%EC%9D%98-%EC%84%A4%EA%B3%84"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> y의 모양: [0 1 0 0 0 0 0 0 0 0]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 활성화함수의 선택: softmax</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 손실함수의 선택: cross entropy</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fashion_MNIST-다중분류">
<a class="anchor" href="#Fashion_MNIST-%EB%8B%A4%EC%A4%91%EB%B6%84%EB%A5%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fashion_MNIST 다중분류<a class="anchor-link" href="#Fashion_MNIST-%EB%8B%A4%EC%A4%91%EB%B6%84%EB%A5%98"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 데이터정리</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([9, 0, 0, ..., 3, 0, 5], dtype=uint8)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0., 0., 0., ..., 0., 0., 1.],
       [1., 0., 0., ..., 0., 0., 0.],
       [1., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [1., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">784</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">XX</span><span class="o">=</span><span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">784</span><span class="p">)</span>
<span class="n">yy</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 시도1: 간단한 신경망</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">splines=line</span>
<span class="s1">subgraph cluster_1{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1"</span>
<span class="s1">    "x2"</span>
<span class="s1">    ".."</span>
<span class="s1">    "x784"</span>
<span class="s1">    label = "Layer 0"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_2{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1" -&gt; "node1"</span>
<span class="s1">    "x2" -&gt; "node1"</span>
<span class="s1">    ".." -&gt; "node1"</span>
<span class="s1">    </span>
<span class="s1">    "x784" -&gt; "node1"</span>
<span class="s1">    "x1" -&gt; "node2"</span>
<span class="s1">    "x2" -&gt; "node2"</span>
<span class="s1">    ".." -&gt; "node2"</span>
<span class="s1">    "x784" -&gt; "node2"</span>
<span class="s1">    </span>
<span class="s1">    "x1" -&gt; "..."</span>
<span class="s1">    "x2" -&gt; "..."</span>
<span class="s1">    ".." -&gt; "..."</span>
<span class="s1">    "x784" -&gt; "..."</span>

<span class="s1">    "x1" -&gt; "node30"</span>
<span class="s1">    "x2" -&gt; "node30"</span>
<span class="s1">    ".." -&gt; "node30"</span>
<span class="s1">    "x784" -&gt; "node30"</span>


<span class="s1">    label = "Layer 1: relu"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_3{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1" -&gt; "y10"</span>
<span class="s1">    "node2" -&gt; "y10"</span>
<span class="s1">    "..." -&gt; "y10"</span>
<span class="s1">    "node30" -&gt; "y10"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "y1"</span>
<span class="s1">    "node2" -&gt; "y1"</span>
<span class="s1">    "..." -&gt; "y1"</span>
<span class="s1">    "node30" -&gt; "y1"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "."</span>
<span class="s1">    "node2" -&gt; "."</span>
<span class="s1">    "..." -&gt; "."</span>
<span class="s1">    "node30" -&gt; "."</span>
<span class="s1">    </span>
<span class="s1">    label = "Layer 2: softmax"</span>
<span class="s1">}</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 3.0.0 (20220315.2325)
 -->
<!-- Title: G Pages: 1 -->
<svg width="384pt" height="261pt" viewbox="0.00 0.00 384.18 261.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 257)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-257 380.18,-257 380.18,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-245 91.59,-245 91.59,-8 8,-8"></polygon>
<text text-anchor="middle" x="49.8" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgrey" stroke="lightgrey" points="111.59,-8 111.59,-245 219.29,-245 219.29,-8 111.59,-8"></polygon>
<text text-anchor="middle" x="165.44" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 1: relu</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_3</title>
<polygon fill="lightgrey" stroke="lightgrey" points="239.29,-35 239.29,-218 376.18,-218 376.18,-35 239.29,-35"></polygon>
<text text-anchor="middle" x="307.73" y="-202.8" font-family="Times,serif" font-size="14.00">Layer 2: softmax</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-196" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-192.3" font-family="Times,serif" font-size="14.00">x1</text>
</g>
<!-- node1 -->
<g id="node5" class="node">
<title>node1</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-196" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-192.3" font-family="Times,serif" font-size="14.00">node1</text>
</g>
<!-- x1&#45;&gt;node1 -->
<g id="edge1" class="edge">
<title>x1-&gt;node1</title>
<path fill="none" stroke="black" d="M76.87,-196C88.57,-196 102.75,-196 116.27,-196"></path>
<polygon fill="black" stroke="black" points="116.42,-199.5 126.42,-196 116.42,-192.5 116.42,-199.5"></polygon>
</g>
<!-- node2 -->
<g id="node6" class="node">
<title>node2</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-142" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-138.3" font-family="Times,serif" font-size="14.00">node2</text>
</g>
<!-- x1&#45;&gt;node2 -->
<g id="edge5" class="edge">
<title>x1-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-185.84C88.01,-178.32 109.97,-167.88 128.5,-159.08"></path>
<polygon fill="black" stroke="black" points="130.01,-162.23 137.54,-154.78 127.01,-155.91 130.01,-162.23"></polygon>
</g>
<!-- ... -->
<g id="node7" class="node">
<title>...</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-84.3" font-family="Times,serif" font-size="14.00">...</text>
</g>
<!-- x1&#45;&gt;... -->
<g id="edge9" class="edge">
<title>x1-&gt;...</title>
<path fill="none" stroke="black" d="M66.12,-181.43C85.53,-163 119.12,-131.07 141.56,-109.74"></path>
<polygon fill="black" stroke="black" points="144.16,-112.11 148.99,-102.68 139.33,-107.03 144.16,-112.11"></polygon>
</g>
<!-- node30 -->
<g id="node8" class="node">
<title>node30</title>
<ellipse fill="none" stroke="black" cx="165.44" cy="-34" rx="44.69" ry="18"></ellipse>
<text text-anchor="middle" x="165.44" y="-30.3" font-family="Times,serif" font-size="14.00">node30</text>
</g>
<!-- x1&#45;&gt;node30 -->
<g id="edge13" class="edge">
<title>x1-&gt;node30</title>
<path fill="none" stroke="black" d="M62.11,-179.87C81.8,-151.81 122.52,-93.76 146.23,-59.97"></path>
<polygon fill="black" stroke="black" points="149.27,-61.72 152.15,-51.52 143.54,-57.7 149.27,-61.72"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-142" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-138.3" font-family="Times,serif" font-size="14.00">x2</text>
</g>
<!-- x2&#45;&gt;node1 -->
<g id="edge2" class="edge">
<title>x2-&gt;node1</title>
<path fill="none" stroke="black" d="M72.17,-152.16C88.01,-159.68 109.97,-170.12 128.5,-178.92"></path>
<polygon fill="black" stroke="black" points="127.01,-182.09 137.54,-183.22 130.01,-175.77 127.01,-182.09"></polygon>
</g>
<!-- x2&#45;&gt;node2 -->
<g id="edge6" class="edge">
<title>x2-&gt;node2</title>
<path fill="none" stroke="black" d="M76.87,-142C88.57,-142 102.75,-142 116.27,-142"></path>
<polygon fill="black" stroke="black" points="116.42,-145.5 126.42,-142 116.42,-138.5 116.42,-145.5"></polygon>
</g>
<!-- x2&#45;&gt;... -->
<g id="edge10" class="edge">
<title>x2-&gt;...</title>
<path fill="none" stroke="black" d="M72.17,-131.84C89.52,-123.6 114.21,-111.87 133.69,-102.61"></path>
<polygon fill="black" stroke="black" points="135.24,-105.75 142.77,-98.3 132.24,-99.43 135.24,-105.75"></polygon>
</g>
<!-- x2&#45;&gt;node30 -->
<g id="edge14" class="edge">
<title>x2-&gt;node30</title>
<path fill="none" stroke="black" d="M66.12,-127.43C84.98,-109.51 117.25,-78.84 139.66,-57.55"></path>
<polygon fill="black" stroke="black" points="142.29,-59.88 147.13,-50.45 137.47,-54.8 142.29,-59.88"></polygon>
</g>
<!-- .. -->
<g id="node3" class="node">
<title>..</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-84.3" font-family="Times,serif" font-size="14.00">..</text>
</g>
<!-- ..&#45;&gt;node1 -->
<g id="edge3" class="edge">
<title>..-&gt;node1</title>
<path fill="none" stroke="black" d="M66.12,-102.57C85.09,-120.59 117.63,-151.51 140.04,-172.81"></path>
<polygon fill="black" stroke="black" points="137.85,-175.56 147.51,-179.91 142.67,-170.48 137.85,-175.56"></polygon>
</g>
<!-- ..&#45;&gt;node2 -->
<g id="edge7" class="edge">
<title>..-&gt;node2</title>
<path fill="none" stroke="black" d="M72.17,-98.16C88.01,-105.68 109.97,-116.12 128.5,-124.92"></path>
<polygon fill="black" stroke="black" points="127.01,-128.09 137.54,-129.22 130.01,-121.77 127.01,-128.09"></polygon>
</g>
<!-- ..&#45;&gt;... -->
<g id="edge11" class="edge">
<title>..-&gt;...</title>
<path fill="none" stroke="black" d="M76.87,-88C91.92,-88 111.09,-88 127.66,-88"></path>
<polygon fill="black" stroke="black" points="128.1,-91.5 138.1,-88 128.1,-84.5 128.1,-91.5"></polygon>
</g>
<!-- ..&#45;&gt;node30 -->
<g id="edge15" class="edge">
<title>..-&gt;node30</title>
<path fill="none" stroke="black" d="M72.17,-77.84C87.5,-70.56 108.57,-60.55 126.7,-51.93"></path>
<polygon fill="black" stroke="black" points="128.33,-55.03 135.86,-47.58 125.33,-48.71 128.33,-55.03"></polygon>
</g>
<!-- x784 -->
<g id="node4" class="node">
<title>x784</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-34" rx="33.6" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-30.3" font-family="Times,serif" font-size="14.00">x784</text>
</g>
<!-- x784&#45;&gt;node1 -->
<g id="edge4" class="edge">
<title>x784-&gt;node1</title>
<path fill="none" stroke="black" d="M62.53,-50.73C82.42,-79.07 122.87,-136.74 146.38,-170.26"></path>
<polygon fill="black" stroke="black" points="143.65,-172.46 152.26,-178.63 149.38,-168.44 143.65,-172.46"></polygon>
</g>
<!-- x784&#45;&gt;node2 -->
<g id="edge8" class="edge">
<title>x784-&gt;node2</title>
<path fill="none" stroke="black" d="M67.08,-49.47C86.18,-67.63 118.05,-97.91 140.09,-118.86"></path>
<polygon fill="black" stroke="black" points="137.79,-121.5 147.45,-125.85 142.61,-116.42 137.79,-121.5"></polygon>
</g>
<!-- x784&#45;&gt;... -->
<g id="edge12" class="edge">
<title>x784-&gt;...</title>
<path fill="none" stroke="black" d="M75.46,-45.72C92.58,-53.85 115.51,-64.75 133.8,-73.44"></path>
<polygon fill="black" stroke="black" points="132.36,-76.63 142.89,-77.76 135.36,-70.31 132.36,-76.63"></polygon>
</g>
<!-- x784&#45;&gt;node30 -->
<g id="edge16" class="edge">
<title>x784-&gt;node30</title>
<path fill="none" stroke="black" d="M83.67,-34C91.95,-34 101.07,-34 110.11,-34"></path>
<polygon fill="black" stroke="black" points="110.23,-37.5 120.23,-34 110.23,-30.5 110.23,-37.5"></polygon>
</g>
<!-- y10 -->
<g id="node9" class="node">
<title>y10</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-61" rx="27.9" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-57.3" font-family="Times,serif" font-size="14.00">y10</text>
</g>
<!-- node1&#45;&gt;y10 -->
<g id="edge17" class="edge">
<title>node1-&gt;y10</title>
<path fill="none" stroke="black" d="M183.3,-179.72C208.39,-155.49 255.6,-109.89 283.65,-82.81"></path>
<polygon fill="black" stroke="black" points="286.26,-85.16 291.02,-75.69 281.4,-80.12 286.26,-85.16"></polygon>
</g>
<!-- y1 -->
<g id="node10" class="node">
<title>y1</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-169" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-165.3" font-family="Times,serif" font-size="14.00">y1</text>
</g>
<!-- node1&#45;&gt;y1 -->
<g id="edge21" class="edge">
<title>node1-&gt;y1</title>
<path fill="none" stroke="black" d="M201.72,-189.19C222.99,-185.08 249.98,-179.87 271.2,-175.77"></path>
<polygon fill="black" stroke="black" points="271.96,-179.19 281.11,-173.85 270.63,-172.31 271.96,-179.19"></polygon>
</g>
<!-- . -->
<g id="node11" class="node">
<title>.</title>
<ellipse fill="none" stroke="black" cx="307.23" cy="-115" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="307.23" y="-111.3" font-family="Times,serif" font-size="14.00">.</text>
</g>
<!-- node1&#45;&gt;. -->
<g id="edge25" class="edge">
<title>node1-&gt;.</title>
<path fill="none" stroke="black" d="M190.47,-182.08C214.53,-168.14 251.56,-146.68 277.24,-131.8"></path>
<polygon fill="black" stroke="black" points="279.24,-134.69 286.14,-126.65 275.73,-128.63 279.24,-134.69"></polygon>
</g>
<!-- node2&#45;&gt;y10 -->
<g id="edge18" class="edge">
<title>node2-&gt;y10</title>
<path fill="none" stroke="black" d="M190.47,-128.08C214.39,-114.22 251.13,-92.93 276.79,-78.06"></path>
<polygon fill="black" stroke="black" points="278.8,-80.94 285.7,-72.9 275.29,-74.89 278.8,-80.94"></polygon>
</g>
<!-- node2&#45;&gt;y1 -->
<g id="edge22" class="edge">
<title>node2-&gt;y1</title>
<path fill="none" stroke="black" d="M201.72,-148.81C222.99,-152.92 249.98,-158.13 271.2,-162.23"></path>
<polygon fill="black" stroke="black" points="270.63,-165.69 281.11,-164.15 271.96,-158.81 270.63,-165.69"></polygon>
</g>
<!-- node2&#45;&gt;. -->
<g id="edge26" class="edge">
<title>node2-&gt;.</title>
<path fill="none" stroke="black" d="M201.72,-135.19C222.99,-131.08 249.98,-125.87 271.2,-121.77"></path>
<polygon fill="black" stroke="black" points="271.96,-125.19 281.11,-119.85 270.63,-118.31 271.96,-125.19"></polygon>
</g>
<!-- ...&#45;&gt;y10 -->
<g id="edge19" class="edge">
<title>...-&gt;y10</title>
<path fill="none" stroke="black" d="M191.76,-83.11C213.65,-78.88 245.56,-72.72 270.13,-67.97"></path>
<polygon fill="black" stroke="black" points="271,-71.37 280.16,-66.04 269.68,-64.5 271,-71.37"></polygon>
</g>
<!-- ...&#45;&gt;y1 -->
<g id="edge23" class="edge">
<title>...-&gt;y1</title>
<path fill="none" stroke="black" d="M186.47,-99.61C210.34,-113.44 250.42,-136.66 277.57,-152.39"></path>
<polygon fill="black" stroke="black" points="275.83,-155.43 286.24,-157.42 279.34,-149.37 275.83,-155.43"></polygon>
</g>
<!-- ...&#45;&gt;. -->
<g id="edge27" class="edge">
<title>...-&gt;.</title>
<path fill="none" stroke="black" d="M191.76,-92.89C213.92,-97.17 246.36,-103.44 271.05,-108.2"></path>
<polygon fill="black" stroke="black" points="270.62,-111.69 281.11,-110.15 271.95,-104.81 270.62,-111.69"></polygon>
</g>
<!-- node30&#45;&gt;y10 -->
<g id="edge20" class="edge">
<title>node30-&gt;y10</title>
<path fill="none" stroke="black" d="M206.13,-41.66C226.24,-45.55 250.49,-50.23 270.09,-54.02"></path>
<polygon fill="black" stroke="black" points="269.67,-57.5 280.15,-55.96 270.99,-50.63 269.67,-57.5"></polygon>
</g>
<!-- node30&#45;&gt;y1 -->
<g id="edge24" class="edge">
<title>node30-&gt;y1</title>
<path fill="none" stroke="black" d="M183.58,-50.55C208.77,-74.88 255.82,-120.32 283.75,-147.29"></path>
<polygon fill="black" stroke="black" points="281.47,-149.95 291.09,-154.38 286.33,-144.91 281.47,-149.95"></polygon>
</g>
<!-- node30&#45;&gt;. -->
<g id="edge28" class="edge">
<title>node30-&gt;.</title>
<path fill="none" stroke="black" d="M191.76,-48.67C215.86,-62.64 252.11,-83.64 277.34,-98.26"></path>
<polygon fill="black" stroke="black" points="275.68,-101.34 286.09,-103.33 279.19,-95.29 275.68,-101.34"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 18s 10ms/step - loss: 2.5281 - accuracy: 0.4108
Epoch 2/5
1875/1875 [==============================] - 18s 10ms/step - loss: 1.2369 - accuracy: 0.4949
Epoch 3/5
1875/1875 [==============================] - 18s 10ms/step - loss: 1.1364 - accuracy: 0.5316
Epoch 4/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.9777 - accuracy: 0.6145
Epoch 5/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.8753 - accuracy: 0.6385
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95d01bddb0&gt;</pre>
</div>

</div>

</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 12ms/step - loss: 0.8944 - accuracy: 0.6563
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.894415020942688, 0.6563000082969666]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 시도2: 더 깊은 신경망</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">splines=line</span>
<span class="s1">subgraph cluster_1{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1"</span>
<span class="s1">    "x2"</span>
<span class="s1">    ".."</span>
<span class="s1">    "x784"</span>
<span class="s1">    label = "Layer 0"</span>
<span class="s1">}</span>
<span class="s1">subgraph cluster_2{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>
<span class="s1">    "x1" -&gt; "node1"</span>
<span class="s1">    "x2" -&gt; "node1"</span>
<span class="s1">    ".." -&gt; "node1"</span>
<span class="s1">    </span>
<span class="s1">    "x784" -&gt; "node1"</span>
<span class="s1">    "x1" -&gt; "node2"</span>
<span class="s1">    "x2" -&gt; "node2"</span>
<span class="s1">    ".." -&gt; "node2"</span>
<span class="s1">    "x784" -&gt; "node2"</span>
<span class="s1">    </span>
<span class="s1">    "x1" -&gt; "..."</span>
<span class="s1">    "x2" -&gt; "..."</span>
<span class="s1">    ".." -&gt; "..."</span>
<span class="s1">    "x784" -&gt; "..."</span>

<span class="s1">    "x1" -&gt; "node500"</span>
<span class="s1">    "x2" -&gt; "node500"</span>
<span class="s1">    ".." -&gt; "node500"</span>
<span class="s1">    "x784" -&gt; "node500"</span>


<span class="s1">    label = "Layer 1: relu"</span>
<span class="s1">}</span>

<span class="s1">subgraph cluster_3{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1" -&gt; "node1(2)"</span>
<span class="s1">    "node2" -&gt; "node1(2)"</span>
<span class="s1">    "..." -&gt; "node1(2)"</span>
<span class="s1">    "node500" -&gt; "node1(2)"</span>

<span class="s1">    "node1" -&gt; "node2(2)"</span>
<span class="s1">    "node2" -&gt; "node2(2)"</span>
<span class="s1">    "..." -&gt; "node2(2)"</span>
<span class="s1">    "node500" -&gt; "node2(2)"</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "...."</span>
<span class="s1">    "node2" -&gt; "...."</span>
<span class="s1">    "..." -&gt; "...."</span>
<span class="s1">    "node500" -&gt; "...."</span>
<span class="s1">    </span>
<span class="s1">    "node1" -&gt; "node500(2)"</span>
<span class="s1">    "node2" -&gt; "node500(2)"</span>
<span class="s1">    "..." -&gt; "node500(2)"</span>
<span class="s1">    "node500" -&gt; "node500(2)"</span>

<span class="s1">    </span>
<span class="s1">    label = "Layer 2: relu"</span>
<span class="s1">}</span>

<span class="s1">subgraph cluster_4{</span>
<span class="s1">    style=filled;</span>
<span class="s1">    color=lightgrey;</span>

<span class="s1">    "node1(2)" -&gt; "y10"</span>
<span class="s1">    "node2(2)" -&gt; "y10"</span>
<span class="s1">    "...." -&gt; "y10"</span>
<span class="s1">    "node500(2)" -&gt; "y10"</span>
<span class="s1">    </span>
<span class="s1">    "node1(2)" -&gt; "y1"</span>
<span class="s1">    "node2(2)" -&gt; "y1"</span>
<span class="s1">    "...." -&gt; "y1"</span>
<span class="s1">    "node500(2)" -&gt; "y1"</span>
<span class="s1">    </span>
<span class="s1">    "node1(2)" -&gt; "."</span>
<span class="s1">    "node2(2)" -&gt; "."</span>
<span class="s1">    "...." -&gt; "."</span>
<span class="s1">    "node500(2)" -&gt; "."</span>
<span class="s1">    </span>
<span class="s1">    label = "Layer 3: softmax"</span>
<span class="s1">}</span>
<span class="s1">'''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 3.0.0 (20220315.2325)
 -->
<!-- Title: G Pages: 1 -->
<svg width="557pt" height="261pt" viewbox="0.00 0.00 557.27 261.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 257)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-257 553.27,-257 553.27,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_1</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-245 91.59,-245 91.59,-8 8,-8"></polygon>
<text text-anchor="middle" x="49.8" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_2</title>
<polygon fill="lightgrey" stroke="lightgrey" points="111.59,-8 111.59,-245 228.99,-245 228.99,-8 111.59,-8"></polygon>
<text text-anchor="middle" x="170.29" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 1: relu</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_3</title>
<polygon fill="lightgrey" stroke="lightgrey" points="248.99,-8 248.99,-245 392.37,-245 392.37,-8 248.99,-8"></polygon>
<text text-anchor="middle" x="320.68" y="-229.8" font-family="Times,serif" font-size="14.00">Layer 2: relu</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_4</title>
<polygon fill="lightgrey" stroke="lightgrey" points="412.37,-35 412.37,-218 549.27,-218 549.27,-35 412.37,-35"></polygon>
<text text-anchor="middle" x="480.82" y="-202.8" font-family="Times,serif" font-size="14.00">Layer 3: softmax</text>
</g>
<!-- x1 -->
<g id="node1" class="node">
<title>x1</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-196" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-192.3" font-family="Times,serif" font-size="14.00">x1</text>
</g>
<!-- node1 -->
<g id="node5" class="node">
<title>node1</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-196" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-192.3" font-family="Times,serif" font-size="14.00">node1</text>
</g>
<!-- x1&#45;&gt;node1 -->
<g id="edge1" class="edge">
<title>x1-&gt;node1</title>
<path fill="none" stroke="black" d="M76.8,-196C89.75,-196 105.84,-196 120.95,-196"></path>
<polygon fill="black" stroke="black" points="121.2,-199.5 131.2,-196 121.2,-192.5 121.2,-199.5"></polygon>
</g>
<!-- node2 -->
<g id="node6" class="node">
<title>node2</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-142" rx="38.99" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-138.3" font-family="Times,serif" font-size="14.00">node2</text>
</g>
<!-- x1&#45;&gt;node2 -->
<g id="edge5" class="edge">
<title>x1-&gt;node2</title>
<path fill="none" stroke="black" d="M72.53,-186.1C89.3,-178.46 112.87,-167.71 132.55,-158.74"></path>
<polygon fill="black" stroke="black" points="134.21,-161.84 141.85,-154.5 131.3,-155.47 134.21,-161.84"></polygon>
</g>
<!-- ... -->
<g id="node7" class="node">
<title>...</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-84.3" font-family="Times,serif" font-size="14.00">...</text>
</g>
<!-- x1&#45;&gt;... -->
<g id="edge9" class="edge">
<title>x1-&gt;...</title>
<path fill="none" stroke="black" d="M66.78,-181.43C87.21,-162.81 122.74,-130.43 146.13,-109.11"></path>
<polygon fill="black" stroke="black" points="148.53,-111.66 153.56,-102.33 143.81,-106.48 148.53,-111.66"></polygon>
</g>
<!-- node500 -->
<g id="node8" class="node">
<title>node500</title>
<ellipse fill="none" stroke="black" cx="170.29" cy="-34" rx="50.89" ry="18"></ellipse>
<text text-anchor="middle" x="170.29" y="-30.3" font-family="Times,serif" font-size="14.00">node500</text>
</g>
<!-- x1&#45;&gt;node500 -->
<g id="edge13" class="edge">
<title>x1-&gt;node500</title>
<path fill="none" stroke="black" d="M62.59,-179.87C83.12,-151.81 125.58,-93.76 150.3,-59.97"></path>
<polygon fill="black" stroke="black" points="153.39,-61.66 156.47,-51.52 147.74,-57.53 153.39,-61.66"></polygon>
</g>
<!-- x2 -->
<g id="node2" class="node">
<title>x2</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-142" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-138.3" font-family="Times,serif" font-size="14.00">x2</text>
</g>
<!-- x2&#45;&gt;node1 -->
<g id="edge2" class="edge">
<title>x2-&gt;node1</title>
<path fill="none" stroke="black" d="M72.53,-151.9C89.3,-159.54 112.87,-170.29 132.55,-179.26"></path>
<polygon fill="black" stroke="black" points="131.3,-182.53 141.85,-183.5 134.21,-176.16 131.3,-182.53"></polygon>
</g>
<!-- x2&#45;&gt;node2 -->
<g id="edge6" class="edge">
<title>x2-&gt;node2</title>
<path fill="none" stroke="black" d="M76.8,-142C89.75,-142 105.84,-142 120.95,-142"></path>
<polygon fill="black" stroke="black" points="121.2,-145.5 131.2,-142 121.2,-138.5 121.2,-145.5"></polygon>
</g>
<!-- x2&#45;&gt;... -->
<g id="edge10" class="edge">
<title>x2-&gt;...</title>
<path fill="none" stroke="black" d="M72.53,-132.1C90.87,-123.74 117.36,-111.66 137.99,-102.26"></path>
<polygon fill="black" stroke="black" points="139.64,-105.36 147.29,-98.02 136.74,-98.99 139.64,-105.36"></polygon>
</g>
<!-- x2&#45;&gt;node500 -->
<g id="edge14" class="edge">
<title>x2-&gt;node500</title>
<path fill="none" stroke="black" d="M66.78,-127.43C86.41,-109.54 120,-78.93 143.35,-57.64"></path>
<polygon fill="black" stroke="black" points="145.81,-60.14 150.84,-50.81 141.09,-54.96 145.81,-60.14"></polygon>
</g>
<!-- .. -->
<g id="node3" class="node">
<title>..</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-84.3" font-family="Times,serif" font-size="14.00">..</text>
</g>
<!-- ..&#45;&gt;node1 -->
<g id="edge3" class="edge">
<title>..-&gt;node1</title>
<path fill="none" stroke="black" d="M66.78,-102.57C86.64,-120.67 120.77,-151.78 144.15,-173.09"></path>
<polygon fill="black" stroke="black" points="141.89,-175.76 151.64,-179.91 146.6,-170.59 141.89,-175.76"></polygon>
</g>
<!-- ..&#45;&gt;node2 -->
<g id="edge7" class="edge">
<title>..-&gt;node2</title>
<path fill="none" stroke="black" d="M72.53,-97.9C89.3,-105.54 112.87,-116.29 132.55,-125.26"></path>
<polygon fill="black" stroke="black" points="131.3,-128.53 141.85,-129.5 134.21,-122.16 131.3,-128.53"></polygon>
</g>
<!-- ..&#45;&gt;... -->
<g id="edge11" class="edge">
<title>..-&gt;...</title>
<path fill="none" stroke="black" d="M76.8,-88C93.2,-88 114.63,-88 132.73,-88"></path>
<polygon fill="black" stroke="black" points="132.94,-91.5 142.94,-88 132.94,-84.5 132.94,-91.5"></polygon>
</g>
<!-- ..&#45;&gt;node500 -->
<g id="edge15" class="edge">
<title>..-&gt;node500</title>
<path fill="none" stroke="black" d="M72.53,-78.1C88.31,-70.91 110.11,-60.97 129.02,-52.35"></path>
<polygon fill="black" stroke="black" points="130.67,-55.44 138.32,-48.11 127.77,-49.08 130.67,-55.44"></polygon>
</g>
<!-- x784 -->
<g id="node4" class="node">
<title>x784</title>
<ellipse fill="none" stroke="black" cx="49.8" cy="-34" rx="33.6" ry="18"></ellipse>
<text text-anchor="middle" x="49.8" y="-30.3" font-family="Times,serif" font-size="14.00">x784</text>
</g>
<!-- x784&#45;&gt;node1 -->
<g id="edge4" class="edge">
<title>x784-&gt;node1</title>
<path fill="none" stroke="black" d="M63.03,-50.73C83.77,-79.07 125.94,-136.74 150.46,-170.26"></path>
<polygon fill="black" stroke="black" points="147.86,-172.63 156.59,-178.63 153.51,-168.49 147.86,-172.63"></polygon>
</g>
<!-- x784&#45;&gt;node2 -->
<g id="edge8" class="edge">
<title>x784-&gt;node2</title>
<path fill="none" stroke="black" d="M67.77,-49.47C87.69,-67.63 120.92,-97.91 143.9,-118.86"></path>
<polygon fill="black" stroke="black" points="141.82,-121.7 151.57,-125.85 146.54,-116.53 141.82,-121.7"></polygon>
</g>
<!-- x784&#45;&gt;... -->
<g id="edge12" class="edge">
<title>x784-&gt;...</title>
<path fill="none" stroke="black" d="M75.93,-45.45C94.06,-53.72 118.66,-64.93 138.05,-73.77"></path>
<polygon fill="black" stroke="black" points="136.83,-77.05 147.38,-78.02 139.74,-70.69 136.83,-77.05"></polygon>
</g>
<!-- x784&#45;&gt;node500 -->
<g id="edge16" class="edge">
<title>x784-&gt;node500</title>
<path fill="none" stroke="black" d="M83.8,-34C91.68,-34 100.33,-34 109.01,-34"></path>
<polygon fill="black" stroke="black" points="109.17,-37.5 119.17,-34 109.17,-30.5 109.17,-37.5"></polygon>
</g>
<!-- node1(2) -->
<g id="node9" class="node">
<title>node1(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-196" rx="51.99" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-192.3" font-family="Times,serif" font-size="14.00">node1(2)</text>
</g>
<!-- node1&#45;&gt;node1(2) -->
<g id="edge17" class="edge">
<title>node1-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M209.5,-196C224.37,-196 241.77,-196 258.3,-196"></path>
<polygon fill="black" stroke="black" points="258.45,-199.5 268.45,-196 258.45,-192.5 258.45,-199.5"></polygon>
</g>
<!-- node2(2) -->
<g id="node10" class="node">
<title>node2(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-142" rx="51.99" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-138.3" font-family="Times,serif" font-size="14.00">node2(2)</text>
</g>
<!-- node1&#45;&gt;node2(2) -->
<g id="edge21" class="edge">
<title>node1-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M201.32,-185.07C222.38,-177.41 250.91,-167.02 274.69,-158.37"></path>
<polygon fill="black" stroke="black" points="276.01,-161.62 284.21,-154.91 273.62,-155.04 276.01,-161.62"></polygon>
</g>
<!-- .... -->
<g id="node11" class="node">
<title>....</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-88" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-84.3" font-family="Times,serif" font-size="14.00">....</text>
</g>
<!-- node1&#45;&gt;.... -->
<g id="edge25" class="edge">
<title>node1-&gt;....</title>
<path fill="none" stroke="black" d="M191.92,-180.98C218.34,-161.76 264.14,-128.42 293.13,-107.32"></path>
<polygon fill="black" stroke="black" points="295.52,-109.91 301.55,-101.2 291.4,-104.25 295.52,-109.91"></polygon>
</g>
<!-- node500(2) -->
<g id="node12" class="node">
<title>node500(2)</title>
<ellipse fill="none" stroke="black" cx="320.68" cy="-34" rx="63.89" ry="18"></ellipse>
<text text-anchor="middle" x="320.68" y="-30.3" font-family="Times,serif" font-size="14.00">node500(2)</text>
</g>
<!-- node1&#45;&gt;node500(2) -->
<g id="edge29" class="edge">
<title>node1-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M186.33,-179.58C212.39,-151.13 266.07,-92.53 296.78,-59"></path>
<polygon fill="black" stroke="black" points="299.53,-61.18 303.7,-51.45 294.36,-56.46 299.53,-61.18"></polygon>
</g>
<!-- node2&#45;&gt;node1(2) -->
<g id="edge18" class="edge">
<title>node2-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M201.32,-152.93C222.38,-160.59 250.91,-170.98 274.69,-179.63"></path>
<polygon fill="black" stroke="black" points="273.62,-182.96 284.21,-183.09 276.01,-176.38 273.62,-182.96"></polygon>
</g>
<!-- node2&#45;&gt;node2(2) -->
<g id="edge22" class="edge">
<title>node2-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M209.5,-142C224.37,-142 241.77,-142 258.3,-142"></path>
<polygon fill="black" stroke="black" points="258.45,-145.5 268.45,-142 258.45,-138.5 258.45,-145.5"></polygon>
</g>
<!-- node2&#45;&gt;.... -->
<g id="edge26" class="edge">
<title>node2-&gt;....</title>
<path fill="none" stroke="black" d="M201.32,-131.07C226.14,-122.04 261.33,-109.23 286.88,-99.93"></path>
<polygon fill="black" stroke="black" points="288.3,-103.14 296.5,-96.43 285.91,-96.56 288.3,-103.14"></polygon>
</g>
<!-- node2&#45;&gt;node500(2) -->
<g id="edge30" class="edge">
<title>node2-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M191.92,-126.98C216.86,-108.84 259.07,-78.11 288.11,-56.98"></path>
<polygon fill="black" stroke="black" points="290.26,-59.74 296.29,-51.02 286.14,-54.08 290.26,-59.74"></polygon>
</g>
<!-- ...&#45;&gt;node1(2) -->
<g id="edge19" class="edge">
<title>...-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M189.19,-101.03C213.88,-119 258.77,-151.67 288.9,-173.6"></path>
<polygon fill="black" stroke="black" points="287.22,-176.7 297.36,-179.76 291.34,-171.04 287.22,-176.7"></polygon>
</g>
<!-- ...&#45;&gt;node2(2) -->
<g id="edge23" class="edge">
<title>...-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M194.48,-96.44C215.89,-104.23 248.3,-116.02 274.78,-125.66"></path>
<polygon fill="black" stroke="black" points="273.64,-128.97 284.23,-129.1 276.03,-122.39 273.64,-128.97"></polygon>
</g>
<!-- ...&#45;&gt;.... -->
<g id="edge27" class="edge">
<title>...-&gt;....</title>
<path fill="none" stroke="black" d="M197.48,-88C221.28,-88 256.62,-88 283.19,-88"></path>
<polygon fill="black" stroke="black" points="283.25,-91.5 293.25,-88 283.25,-84.5 283.25,-91.5"></polygon>
</g>
<!-- ...&#45;&gt;node500(2) -->
<g id="edge31" class="edge">
<title>...-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M194.48,-79.56C214.93,-72.12 245.41,-61.03 271.18,-51.65"></path>
<polygon fill="black" stroke="black" points="272.59,-54.86 280.79,-48.15 270.19,-48.28 272.59,-54.86"></polygon>
</g>
<!-- node500&#45;&gt;node1(2) -->
<g id="edge20" class="edge">
<title>node500-&gt;node1(2)</title>
<path fill="none" stroke="black" d="M186.89,-51.03C213.2,-79.76 266.52,-137.97 296.98,-171.22"></path>
<polygon fill="black" stroke="black" points="294.51,-173.7 303.84,-178.71 299.67,-168.97 294.51,-173.7"></polygon>
</g>
<!-- node500&#45;&gt;node2(2) -->
<g id="edge24" class="edge">
<title>node500-&gt;node2(2)</title>
<path fill="none" stroke="black" d="M193.5,-50.17C218.86,-68.62 260.48,-98.91 288.94,-119.62"></path>
<polygon fill="black" stroke="black" points="287.17,-122.67 297.31,-125.72 291.29,-117.01 287.17,-122.67"></polygon>
</g>
<!-- node500&#45;&gt;.... -->
<g id="edge28" class="edge">
<title>node500-&gt;....</title>
<path fill="none" stroke="black" d="M206.46,-46.8C230.75,-55.64 262.86,-67.32 286.67,-75.99"></path>
<polygon fill="black" stroke="black" points="285.73,-79.37 296.33,-79.5 288.12,-72.79 285.73,-79.37"></polygon>
</g>
<!-- node500&#45;&gt;node500(2) -->
<g id="edge32" class="edge">
<title>node500-&gt;node500(2)</title>
<path fill="none" stroke="black" d="M221.11,-34C229.34,-34 238.02,-34 246.68,-34"></path>
<polygon fill="black" stroke="black" points="246.81,-37.5 256.81,-34 246.81,-30.5 246.81,-37.5"></polygon>
</g>
<!-- y10 -->
<g id="node13" class="node">
<title>y10</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-61" rx="27.9" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-57.3" font-family="Times,serif" font-size="14.00">y10</text>
</g>
<!-- node1(2)&#45;&gt;y10 -->
<g id="edge33" class="edge">
<title>node1(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M341.33,-179.18C370.12,-154.52 423.73,-108.61 454.98,-81.84"></path>
<polygon fill="black" stroke="black" points="457.47,-84.32 462.79,-75.16 452.92,-79 457.47,-84.32"></polygon>
</g>
<!-- y1 -->
<g id="node14" class="node">
<title>y1</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-169" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-165.3" font-family="Times,serif" font-size="14.00">y1</text>
</g>
<!-- node1(2)&#45;&gt;y1 -->
<g id="edge37" class="edge">
<title>node1(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M367.7,-188.12C392.02,-183.95 421.41,-178.92 443.93,-175.06"></path>
<polygon fill="black" stroke="black" points="444.8,-178.46 454.06,-173.33 443.62,-171.56 444.8,-178.46"></polygon>
</g>
<!-- . -->
<g id="node15" class="node">
<title>.</title>
<ellipse fill="none" stroke="black" cx="480.32" cy="-115" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="480.32" y="-111.3" font-family="Times,serif" font-size="14.00">.</text>
</g>
<!-- node1(2)&#45;&gt;. -->
<g id="edge41" class="edge">
<title>node1(2)-&gt;.</title>
<path fill="none" stroke="black" d="M350.59,-181.14C378.54,-166.78 420.72,-145.11 449.1,-130.53"></path>
<polygon fill="black" stroke="black" points="450.86,-133.56 458.16,-125.87 447.66,-127.33 450.86,-133.56"></polygon>
</g>
<!-- node2(2)&#45;&gt;y10 -->
<g id="edge34" class="edge">
<title>node2(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M350.59,-127.14C378.38,-112.86 420.24,-91.36 448.61,-76.78"></path>
<polygon fill="black" stroke="black" points="450.39,-79.8 457.68,-72.12 447.19,-73.58 450.39,-79.8"></polygon>
</g>
<!-- node2(2)&#45;&gt;y1 -->
<g id="edge38" class="edge">
<title>node2(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M367.7,-149.88C392.02,-154.05 421.41,-159.08 443.93,-162.94"></path>
<polygon fill="black" stroke="black" points="443.62,-166.44 454.06,-164.67 444.8,-159.54 443.62,-166.44"></polygon>
</g>
<!-- node2(2)&#45;&gt;. -->
<g id="edge42" class="edge">
<title>node2(2)-&gt;.</title>
<path fill="none" stroke="black" d="M367.7,-134.12C392.02,-129.95 421.41,-124.92 443.93,-121.06"></path>
<polygon fill="black" stroke="black" points="444.8,-124.46 454.06,-119.33 443.62,-117.56 444.8,-124.46"></polygon>
</g>
<!-- ....&#45;&gt;y10 -->
<g id="edge35" class="edge">
<title>....-&gt;y10</title>
<path fill="none" stroke="black" d="M347.01,-83.66C373.01,-79.21 413.72,-72.24 443.12,-67.2"></path>
<polygon fill="black" stroke="black" points="443.74,-70.65 453,-65.51 442.56,-63.75 443.74,-70.65"></polygon>
</g>
<!-- ....&#45;&gt;y1 -->
<g id="edge39" class="edge">
<title>....-&gt;y1</title>
<path fill="none" stroke="black" d="M342.61,-98.76C369.94,-112.8 417.95,-137.46 449.19,-153.52"></path>
<polygon fill="black" stroke="black" points="447.81,-156.74 458.3,-158.2 451.01,-150.52 447.81,-156.74"></polygon>
</g>
<!-- ....&#45;&gt;. -->
<g id="edge43" class="edge">
<title>....-&gt;.</title>
<path fill="none" stroke="black" d="M347.01,-92.34C373.32,-96.85 414.7,-103.93 444.17,-108.98"></path>
<polygon fill="black" stroke="black" points="443.61,-112.43 454.06,-110.67 444.79,-105.53 443.61,-112.43"></polygon>
</g>
<!-- node500(2)&#45;&gt;y10 -->
<g id="edge36" class="edge">
<title>node500(2)-&gt;y10</title>
<path fill="none" stroke="black" d="M375.49,-43.22C397.82,-47.04 423.14,-51.38 443.18,-54.81"></path>
<polygon fill="black" stroke="black" points="442.69,-58.28 453.14,-56.52 443.88,-51.38 442.69,-58.28"></polygon>
</g>
<!-- node500(2)&#45;&gt;y1 -->
<g id="edge40" class="edge">
<title>node500(2)-&gt;y1</title>
<path fill="none" stroke="black" d="M341.64,-51.1C370.55,-75.85 423.97,-121.6 455.09,-148.25"></path>
<polygon fill="black" stroke="black" points="452.99,-151.06 462.86,-154.91 457.55,-145.74 452.99,-151.06"></polygon>
</g>
<!-- node500(2)&#45;&gt;. -->
<g id="edge44" class="edge">
<title>node500(2)-&gt;.</title>
<path fill="none" stroke="black" d="M352.45,-49.81C380.34,-64.14 421.22,-85.14 448.98,-99.41"></path>
<polygon fill="black" stroke="black" points="447.71,-102.69 458.21,-104.15 450.91,-96.47 447.71,-102.69"></polygon>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Output" data-close="Show Output"></summary>
        <p>
</p>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 18s 10ms/step - loss: 2.2519 - accuracy: 0.7419
Epoch 2/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.6466 - accuracy: 0.7918
Epoch 3/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.5628 - accuracy: 0.8116
Epoch 4/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4696 - accuracy: 0.8359
Epoch 5/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4355 - accuracy: 0.8469
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddfdbdc0&gt;</pre>
</div>

</div>

</div>
</div>

    </details>
</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 12ms/step - loss: 0.4929 - accuracy: 0.8289
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.4929366707801819, 0.8288999795913696]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>  <span class="c1">#사용한 파라미터 수 확인 : 648010</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_4 (Dense)             (None, 500)               392500    
                                                                 
 dense_5 (Dense)             (None, 500)               250500    
                                                                 
 dense_6 (Dense)             (None, 10)                5010      
                                                                 
=================================================================
Total params: 648,010
Trainable params: 648,010
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>accuracy는 두번째 네트워크가 더 좋지만 파라미터가 좀 낭비되었다고 생각할 수도 있겠다..</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="평가지표">
<a class="anchor" href="#%ED%8F%89%EA%B0%80%EC%A7%80%ED%91%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>평가지표<a class="anchor-link" href="#%ED%8F%89%EA%B0%80%EC%A7%80%ED%91%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="다양한-평가지표들">
<a class="anchor" href="#%EB%8B%A4%EC%96%91%ED%95%9C-%ED%8F%89%EA%B0%80%EC%A7%80%ED%91%9C%EB%93%A4" aria-hidden="true"><span class="octicon octicon-link"></span></a>다양한 평가지표들<a class="anchor-link" href="#%EB%8B%A4%EC%96%91%ED%95%9C-%ED%8F%89%EA%B0%80%EC%A7%80%ED%91%9C%EB%93%A4"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 의문: 왜 다양한 평가지표가 필요한가? (accuracy면 끝나는거 아닌가? 더 이상 뭐가 필요해?)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 여러가지 평가지표들: <a href="https://en.wikipedia.org/wiki/Positive_and_negative_predictive_values">https://en.wikipedia.org/wiki/Positive_and_negative_predictive_values</a></p>
<ul>
<li>이걸 다 암기하는건 불가능함. </li>
<li>몇 개만 뽑아서 암기하고 왜 쓰는지만 생각해보고 넘어가자!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="confusion-matrix의-이해">
<a class="anchor" href="#confusion-matrix%EC%9D%98-%EC%9D%B4%ED%95%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>confusion matrix의 이해<a class="anchor-link" href="#confusion-matrix%EC%9D%98-%EC%9D%B4%ED%95%B4"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 표1</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">퇴사(예측)</th>
<th style="text-align:center">안나감(예측)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">퇴사(실제)</td>
<td style="text-align:center">TP</td>
<td style="text-align:center">FN</td>
</tr>
<tr>
<td style="text-align:center">안나감(실제)</td>
<td style="text-align:center">FP</td>
<td style="text-align:center">TN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 표2 (책에없음)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">퇴사(예측)</th>
<th style="text-align:center">안나감(예측)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">퇴사(실제)</td>
<td style="text-align:center">$(y,\hat{y})= $ (O,O)</td>
<td style="text-align:center">$(y,\hat{y})= $(O,X)</td>
</tr>
<tr>
<td style="text-align:center">안나감(실제)</td>
<td style="text-align:center">$(y,\hat{y})= $(X,O)</td>
<td style="text-align:center">$(y,\hat{y})= $(X,X)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 표3 (책에없음)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">퇴사(예측)</th>
<th style="text-align:center">안나감(예측)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">퇴사(실제)</td>
<td style="text-align:center">TP, $\# O/O$</td>
<td style="text-align:center">FN, $\#O/X$</td>
</tr>
<tr>
<td style="text-align:center">안나감(실제)</td>
<td style="text-align:center">FP, $\#X/O$</td>
<td style="text-align:center">TN, $\#X/X$</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>암기법, (1) 두번째 글자를 그대로 쓴다 (2) 첫글자가 T이면 분류를 제대로한것, 첫글자가 F이면 분류를 잘못한것</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 표4 (위키등에 있음)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">퇴사(예측)</th>
<th style="text-align:center">안나감(예측)</th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">퇴사(실제)</td>
<td style="text-align:center">TP, $\# O/O$</td>
<td style="text-align:center">FN, $\# O/X$</td>
<td style="text-align:center">Sensitivity(민감도)=Recall(재현율)=$\frac{TP}{TP+FN}$=$\frac{\#O/O}{\# O/O+ \#O/X}$</td>
</tr>
<tr>
<td style="text-align:center">안나감(실제)</td>
<td style="text-align:center">FP, $\# X/O$</td>
<td style="text-align:center">TN, $\# X/X$</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">Precision(프리시즌,정밀도)=$\frac{TP}{TP+FP}$=$\frac{\# O/O}{\# O/O+\# X/O}$</td>
<td style="text-align:center"></td>
<td style="text-align:center">Accuracy(애큐러시,정확도)=$\frac{TP+TN}{total}$=$\frac{\#O/O+\# X/X}{total}$</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="상황극">
<a class="anchor" href="#%EC%83%81%ED%99%A9%EA%B7%B9" aria-hidden="true"><span class="octicon octicon-link"></span></a>상황극<a class="anchor-link" href="#%EC%83%81%ED%99%A9%EA%B7%B9"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 최규빈은 입사하여 "퇴사자 예측시스템"의 개발에 들어갔다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 자료의 특성상 대부분의 사람이 퇴사하지 않고 회사에 잘 다닌다. 즉 1000명이 있으면 10명정도 퇴사한다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Accuracy">
<a class="anchor" href="#Accuracy" aria-hidden="true"><span class="octicon octicon-link"></span></a>Accuracy<a class="anchor-link" href="#Accuracy"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의: Accuracy(애큐러시)=$\frac{TP+TN}{total}$=$\frac{\#O/O+ \#X/X}{total}$</p>
<ul>
<li>한국말로는 정확도, 정분류율이라고 한다. </li>
<li>한국말이 헷갈리므로 그냥 영어를 외우는게 좋다. (어차피 Keras에서 옵션도 영어로 넣음) </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (상확극 시점1) 왜 애큐러시는 불충분한가?</p>
<ul>
<li>회사: 퇴사자예측프로그램 개발해</li>
<li>최규빈: 귀찮은데 다 안 나간다고 하자! -&gt; 99퍼의 accuracy </li>
</ul>
<blockquote>
<p>모델에 사용한 파라메터 = 0. 그런데 애큐러시 = .99! 이거 엄청 좋은 모형이다?</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sensitivity(민감도),-Recall(재현율),-True-Positive-Rate(TPR)">
<a class="anchor" href="#Sensitivity(%EB%AF%BC%EA%B0%90%EB%8F%84),-Recall(%EC%9E%AC%ED%98%84%EC%9C%A8),-True-Positive-Rate(TPR)" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sensitivity(민감도), Recall(재현율), True Positive Rate(TPR)<a class="anchor-link" href="#Sensitivity(%EB%AF%BC%EA%B0%90%EB%8F%84),-Recall(%EC%9E%AC%ED%98%84%EC%9C%A8),-True-Positive-Rate(TPR)"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의: Sensitivity(민감도)=Recall(재현율)=$\frac{TP}{TP+FN}$=$\frac{\# O/O}{\# O/O+\# O/X}$</p>
<ul>
<li>분모: 실제 O인 관측치 수 </li>
<li>분자: 실제 O를 O라고 예측한 관측치 수 </li>
<li>뜻: 실제 O를 O라고 예측한 비율</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (상황극 시점2) recall을 봐야하는 이유</p>
<ul>
<li>인사팀: 실제 퇴사자를 퇴사자로 예측해야 의미가 있음! 우리는 퇴사할것 같은 10명을 찍어달란 의미였어요! (그래야 면담을 하든 할거아냐!) </li>
<li>최규빈: 가볍고(=파라메터 적고) 잘 맞추는 모형 만들어 달라면서요?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인사팀: (고민중..) 사실 생각해보니까 이 경우는 애큐러시는 의미가 없네. 실제 나간 사람 중 최규빈이 나간다고 한 사람이 몇인지 카운트 하는게 더 의미가 있겠다. 우리는 앞으로 리컬(혹은 민감도)를 보겠다! <blockquote>
<p>예시1:실제로 퇴사한 10명중 최규빈이 나간다고 찍은 사람이 5명이면 리컬이 50% &gt; 예시2:최규빈이 아무도 나가지 않는다고 예측해버린다? 실제 10명중에서 최규빈이 나간다고 적중시킨사람은 0명이므로 이 경우 리컬은 0%</p>
</blockquote>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>결론: 우리가 필요한건 recall이니까 앞으로 recall을 가져와! accuracy는 큰 의미없어. (그래도 명색이 모델인데 accuracy가 90은 되면 좋겠다)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Precision">
<a class="anchor" href="#Precision" aria-hidden="true"><span class="octicon octicon-link"></span></a>Precision<a class="anchor-link" href="#Precision"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의: Precision(프리시즌)=$\frac{TP}{TP+FP}$=$\frac{\# O/O}{\# O/O+\# X/O}$</p>
<ul>
<li>분모: O라고 예측한 관측치</li>
<li>분자: O라고 예측한 관측치중 진짜 O인 관측치 </li>
<li>뜻: O라고 예측한 관측치중 진짜 O인 비율</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (상황극 시점3) recall 만으로 불충분한 이유</p>
<ul>
<li>최규빈: 에휴.. 귀찮은데 그냥 좀만 수틀리면 다 나갈것 같다고 해야겠다. cut value를 낮게 잡아야징 -&gt; 한 100명 나간다고 했음 -&gt; 실제로 최규빈이 찍은 100명중에 10명이 다 나감!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>이 경우 애큐러시는 91%, 리컬은 100% (퇴사자 10명을 일단은 다 맞췄으므로).</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>인사팀: (화가 많이 남) 멀쩡한 사람까지 다 퇴사할 것 같다고 하면 어떡해요? 최규빈 연구원이 나간다고 한 100명중에 실제로 10명만 나갔어요.</p>
</li>
<li>
<p>인사팀: 마치 총으로 과녁중앙에 맞춰 달라고 했더니 기관총을 가져와서 한번 긁은것이랑 뭐가 달라요? 맞추는게 문제가 아니고 precision이 너무 낮아요.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>최규빈: accuracy 90% 이상, recall은 높을수록 좋다는게 주문 아니었나요? </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인사팀: (고민중..) 앞으로는 recall과 함께 precision도 같이 제출하세요. precision은 당신이 나간다고 한 사람중에 실제 나간사람의 비율을 의미해요. 이 경우는 $\frac{10}{100}$이니까 precision이 10%입니다. (속마음: recall 올리겠다고 무작정 너무 많이 예측하지 말란 말이야!) </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="F1-score">
<a class="anchor" href="#F1-score" aria-hidden="true"><span class="octicon octicon-link"></span></a>F1 score<a class="anchor-link" href="#F1-score"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의: recall과 precision의 조화평균</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (상황극 시점4) recall, precision을 모두 고려</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>최규빈: recall/precision을 같이 내는건 좋은데요, 둘은 trade off의 관계에 있습니다. 물론 둘다 올리는 모형이 있다면 좋지만 그게 쉽지는 않아요. 보통은 precision을 올리려면 recall이 희생되는 면이 있고요, recall을 올리려고 하면 precision이 다소 떨어집니다.</p>
</li>
<li>
<p>최규빈: 평가기준이 애매하다는 의미입니다. 모형1,2가 있는데 모형1은 모형2보다 precision이 약간 좋고 대신 recall이 떨어진다면 모형1이 좋은것입니까? 아니면 모형2가 좋은것입니까?</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인사팀: 그렇다면 둘을 평균내서 F1score를 계산해서 제출해주세요. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Specificity(특이도),-False-Positive-Rate(FPR)">
<a class="anchor" href="#Specificity(%ED%8A%B9%EC%9D%B4%EB%8F%84),-False-Positive-Rate(FPR)" aria-hidden="true"><span class="octicon octicon-link"></span></a>Specificity(특이도), False Positive Rate(FPR)<a class="anchor-link" href="#Specificity(%ED%8A%B9%EC%9D%B4%EB%8F%84),-False-Positive-Rate(FPR)"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의:</p>
<p>(1) Specificity(특이도)=$\frac{TN}{FP+TN}$=$\frac{\# X/X}{\# X/O+\# X/X}$</p>
<p>(2) False Positive Rate (FPR) = 1-Specificity(특이도) = $\frac{FP}{FP+TN}$=$\frac{\# X/O}{\# X/O+\# X/X}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 의미: <strong>FPR = 오해해서 미안해, recall(=TPR)을 올리려고 보니 어쩔 수 없었어 ㅠㅠ</strong></p>
<ul>
<li>specificity는 안나간 사람을 안나갔다고 찾아낸 비율인데 별로 안중요하다. </li>
<li>FPR은 recall을 올리기 위해서 "실제로는 회사 잘 다니고 있는 사람 중 최규빈이 나갈것 같다고 찍은 사람들" 의 비율이다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>즉 생사람잡은 비율.. 오해해서 미안한 사람의 비율..</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ROC-curve">
<a class="anchor" href="#ROC-curve" aria-hidden="true"><span class="octicon octicon-link"></span></a>ROC curve<a class="anchor-link" href="#ROC-curve"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 정의: $x$축=FPR, $y$축=TPR 을 그린 커브</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 의미:</p>
<ul>
<li>결국 "오해해서 미안해 vs recall"을 그린 곡선이 ROC커브이다. </li>
<li>생각해보면 오해하는 사람이 많을수록 당연히 recall은 올라간다. 따라서 우상향하는 곡선이다. </li>
<li>오해한 사람이 매우 적은데 recall이 우수하면 매우 좋은 모형이다. 그래서 초반부터 ROC값이 급격하게 올라가면 좋은 모형이다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="fashion_mnist-(revisit)">
<a class="anchor" href="#fashion_mnist-(revisit)" aria-hidden="true"><span class="octicon octicon-link"></span></a>fashion_mnist (revisit)<a class="anchor-link" href="#fashion_mnist-(revisit)"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span> 
<span class="kn">import</span> <span class="nn">tensorflow.experimental.numpy</span> <span class="k">as</span> <span class="nn">tnp</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">experimental_enable_numpy_behavior</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> fashion mnist data 다시 불러오자</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fashion_mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(60000, 28, 28)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이미지는 원래 가로픽셀 <em> 세로픽셀 </em> 3 이어야 한다. (색을 표현하는 basis는 빨,녹,파)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 따라서 이미지의 차원이 단지 (28,28)이라는 것은 흑백이미지라는 뜻이다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x7f94f4693970&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD4CAYAAAAq5pAIAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAUFElEQVR4nO3da2yc1ZkH8P8z4/ElzjiJk+CE4BIuoZDCEqhJuIlSKDREVQOli4gQC1K0QbvQbbt8ANGuyn5ZIbSA0LLbXQNZwqpQtSoIiiIKmEsWKGlMSHPdEEgcEuPYTkxsx/HYc3n2g1+oCT7Pa+adGzn/n2R5PM+cmeMZ//3OzJlzjqgqiOj4Fyt3B4ioNBh2Ik8w7ESeYNiJPMGwE3miqpQ3Vi01Wov6Ut4kkVdSGMKojshEtUhhF5GlAB4GEAfwmKreZ12+FvVYIldGuUkiMqzXNmct76fxIhIH8O8ArgGwEMAKEVmY7/URUXFFec2+GMAHqrpbVUcB/BrA8sJ0i4gKLUrY5wHYN+7n/cF5nyMiq0SkXUTa0xiJcHNEFEXR341X1VZVbVHVlgRqin1zROQQJeydAJrH/XxScB4RVaAoYd8AYIGInCIi1QBuBPB8YbpFRIWW99CbqmZE5A4Af8DY0NtqVd1WsJ4RUUFFGmdX1bUA1haoL0RURPy4LJEnGHYiTzDsRJ5g2Ik8wbATeYJhJ/IEw07kCYadyBMMO5EnGHYiTzDsRJ5g2Ik8wbATeaKkS0lTGciEqwr/RcSNPeMzG836J989w1lreOqdSLcd9rtJVcJZ0/RotNuOKuxxseT5mPHITuQJhp3IEww7kScYdiJPMOxEnmDYiTzBsBN5guPsxzmJx826ZjJmPbbI3qtzx21T7fbD7lpiaLHZtmo4Z9YTL7Wb9Uhj6WFj+CH3K8Q+jkbpm1QZsTUeTh7ZiTzBsBN5gmEn8gTDTuQJhp3IEww7kScYdiJPcJz9OGeOySJ8nH3fd6eb9Zsu+l+z/lbvqc7a3po5ZlutM8uo+s5FZv2M/+h01jIdH9lXHjJnPOx+CxOfMcNdzGbNttmBAXfR6HaksItIB4BBAFkAGVVtiXJ9RFQ8hTiyf1tVDxbgeoioiPiancgTUcOuAF4SkXdFZNVEFxCRVSLSLiLtaYxEvDkiylfUp/GXqmqniJwA4GUR+T9VXTf+AqraCqAVABqkMdrqhkSUt0hHdlXtDL73AHgWgD2NiYjKJu+wi0i9iCQ/PQ3gagBbC9UxIiqsKE/jmwA8K2PzfqsAPKWqLxakV1QwuVQqUvvR846Y9R9Os+eU18bSztobMXu+euerzWY9+1d23/Y+mHTWcu9dbLadudUe6254r8usH7xsnlnv/ab7FW1TyHL6M1750FmTPnek8w67qu4GcG6+7YmotDj0RuQJhp3IEww7kScYdiJPMOxEnhCNuGXvl9EgjbpErizZ7XnDWvY45PE9csOFZv2an79u1s+q/disD+ZqnbVRjfYBzkd2fsusD+2e5qzFRkO2TA4pZ5vspaA1bR9HZ2x0/+51y7vNtvLobGdtc9vDONK3b8Le88hO5AmGncgTDDuRJxh2Ik8w7ESeYNiJPMGwE3mC4+yVIGR74EhCHt+z37X/3/9ghj2FNUzcWNt4SKvNtoez9ZFuuzfjnuKaDhnjf2yXPQX2iDGGDwCxjP2YXvXt95y16xs3mG3vP+0cZ229tmFA+zjOTuQzhp3IEww7kScYdiJPMOxEnmDYiTzBsBN5gls2V4ISftbhWLuOnGDWDzVMNesHMtPN+sy4e7nnZGzYbDs/Ye8X2pt1j6MDQDzhXqp6VONm23/+xu/NeuqshFlPiL0U9cXGOgB/vf1vzLb12G3WXXhkJ/IEw07kCYadyBMMO5EnGHYiTzDsRJ5g2Ik8wXF2z82usbc9rhX3lssAUC0Zs/5xeoaztmv462bb9wfszwAsbdpm1tPGWLo1zx4IHyc/MfGJWU+pPQ5v3auXNNnj6JvMqlvokV1EVotIj4hsHXdeo4i8LCK7gu/uR5SIKsJknsY/AWDpMefdDaBNVRcAaAt+JqIKFhp2VV0HoO+Ys5cDWBOcXgPg2sJ2i4gKLd/X7E2q2hWcPgCgyXVBEVkFYBUA1GJKnjdHRFFFfjdex1asdL7boaqtqtqiqi0J1ES9OSLKU75h7xaRuQAQfO8pXJeIqBjyDfvzAG4JTt8C4LnCdIeIiiX0NbuIPA3gcgCzRGQ/gF8AuA/Ab0RkJYC9AG4oZiePeyHrxkvcnnutGfdYd3yGPSr6relbzHpvtsGsH87a78NMjx911gYz7r3bAaBv2L7uM2u6zPrGo/OdtdnV9ji51W8A6BidZdYX1Bww6/d3u/dPaK499v3wz8tceZmzpuv/6KyFhl1VVzhK3O2B6CuEH5cl8gTDTuQJhp3IEww7kScYdiJPcIprJQhZSlqq7IfJGnrbt/Iss+0VU+wlk99OzTPrs6sGzbo1zXRuTb/ZNtmUMuthw36NVe7pu4PZOrPtlNiIWQ/7vc+vtpfB/ukr5ztrybMPmW0bEsYx2hjF5ZGdyBMMO5EnGHYiTzDsRJ5g2Ik8wbATeYJhJ/IEx9krgCSqzXouZY83W2ZtGTXrB7P2ksfTY/ZUz+qQJZetrZEvbtxjtu0NGQvfOHyKWU/G3VtCz47Z4+TNCXuse0uq2ayvHTrdrK/83ivO2tOtV5ltq19821kTdT9ePLITeYJhJ/IEw07kCYadyBMMO5EnGHYiTzDsRJ74ao2zG0suS5U9XizxkP9rMbueSxnzm3P2WHMYTdtj4VE8/F+PmPV9melm/UDaroctuZw1Jli/MzzNbFsbs7eLnl01YNYHcvY4vWUwZy9zbc3TB8L7ftfMXc7aM/3fMdvmi0d2Ik8w7ESeYNiJPMGwE3mCYSfyBMNO5AmGncgTFTXOHmV99LCxarWHPctqePlis77vWnsc/6bz/uSsHcgkzbbvGdsaA8A0Y044ANSHrK+eUvfnHz4etbeTDhurttaFB4ATjHH4rNrHuc603bcwYZ8/2J8x1rT/vj3XfvqTeXUp/MguIqtFpEdEto47714R6RSRTcHXsvxunohKZTJP458AsHSC8x9S1UXB19rCdouICi007Kq6DkBfCfpCREUU5Q26O0Rkc/A03/kCR0RWiUi7iLSnYb++I6LiyTfsvwRwGoBFALoAPOC6oKq2qmqLqrYkUJPnzRFRVHmFXVW7VTWrqjkAjwKw304morLLK+wiMnfcj9cB2Oq6LBFVhtBxdhF5GsDlAGaJyH4AvwBwuYgsAqAAOgDcVojOWOPoUVXNnWPW06c0mfW+s9x7gR+dY2yKDWDRsh1m/dam/zbrvdkGs54QY3/29Eyz7XlTOsz6q/0LzfrBqqlm3Rqnv7jePacbAA7n7P3XT6z6xKzf9cEPnbWmKfZY9mMn2wNMac2Z9Z1p+yVrf849H/4fFr5mtn0Ws826S2jYVXXFBGc/ntetEVHZ8OOyRJ5g2Ik8wbATeYJhJ/IEw07kiYqa4jpyzQVm/YSf7XbWFjXsN9surHvTrKdy9lLU1nTL7cPzzLZHc/aWzLtG7WHB/ow9BBUX9zBQz6g9xfWBPfayxW2L/9Os//zjieZI/UWsTp21Q1l72O76qfZS0YD9mN32tXXO2qnVPWbbF4bmmvWPQ6bANiX6zfr8RK+z9oPk+2bbfIfeeGQn8gTDTuQJhp3IEww7kScYdiJPMOxEnmDYiTxR2nF2sZeLXvIvG8zmVya3OWtH1Z5SGDaOHjZuaplWZS8bPJK27+aetD2FNcwZNQectesaNplt1z2yxKxfmvqRWf/wCnt6btuweypnb8b+vW/cc4VZ3/hRs1m/cP4eZ+2cZKfZNuyzDcl4yqxb044BYCjn/nt9J2V//iBfPLITeYJhJ/IEw07kCYadyBMMO5EnGHYiTzDsRJ4QVfd840Krm9Osp938j8566+3/ZrZ/qu9CZ6251t6O7uTqg2Z9Ztze/teSjNljrl9P2GOuLwydZNZfP3ymWf9mssNZS4i93fPlUz4w67f+9E6znqm1l9EemO8+nmTq7b+9hnMPmfUfnf6qWa82fvfDWXscPex+C9uSOYy1BkEyZm+T/cCy65y1P3Y8gf7hrgkfFB7ZiTzBsBN5gmEn8gTDTuQJhp3IEww7kScYdiJPlHQ+eywNTOl2jy++MLDIbH9qnXut7YNpe330Pxw5x6yfVGdv/2ttPXy6MZ8cADalppv1F3u/YdZPrLPXT+9OT3PWDqXrzbZHjXnVAPD4Qw+a9Qe67XXnr2vc6KydW22Pox/O2cei7SHr7Q/map21lNrrG/SHjMMnjb8HAEirHa24seXz9Jg9hj9wjnsb7my3+3ZDj+wi0iwir4nIdhHZJiI/Ds5vFJGXRWRX8D3/1R+IqOgm8zQ+A+BOVV0I4EIAt4vIQgB3A2hT1QUA2oKfiahChYZdVbtUdWNwehDADgDzACwHsCa42BoA1xapj0RUAF/qDToRmQ/gPADrATSpaldQOgCgydFmlYi0i0h7ZmQoSl+JKIJJh11EpgL4HYCfqOrn3jHSsdk0E85qUNVWVW1R1ZaqGvvNIiIqnkmFXUQSGAv6r1T1meDsbhGZG9TnArC3xSSisgodehMRAfA4gB2qOn4c5nkAtwC4L/j+XNh1xUdzSO4bcdZzak+XfPWge6pnU+2g2XZRcp9Z33nUHsbZMnyis7ax6mtm27q4e7tnAJhWbU+Rra9y32cAMCvh/t1PqbH/B1vTQAFgQ8r+3f5u9utm/aOMe5Dm90NnmG23H3Xf5wAwI2QJ7y0D7vZHM/Y22iNZOxqpjD2UO63GfkwvaNzrrO2EvV1077nGtOG33O0mM85+CYCbAWwRkU3BefdgLOS/EZGVAPYCuGES10VEZRIadlV9E4DrkHtlYbtDRMXCj8sSeYJhJ/IEw07kCYadyBMMO5EnSrtl85FhxN54z1n+7UuXmM3/aflvnbU3QpZbfuGAPS46MGpP9Zw9xf1R3wZjnBsAGhP2x4TDtnyuDdn+95OM+5OJIzF7KmfWOdAy5sCIe/osALyVW2DW0zn3ls0jRg0I/3xC3+gss35iXb+zNphxT38FgI7BRrN+sN/eVjk1xY7Wm9nTnLWlc9xbkwNAXY/7MYsZfyo8shN5gmEn8gTDTuQJhp3IEww7kScYdiJPMOxEnijpls0N0qhLJP+Jcv03ubdsPvXvd5ptF0/fY9Y3Dtjztj8yxl3TIUseJ2LuZYMBYEpi1KzXhow3V8fdc9JjEy8g9JlcyDh7fdzuW9hc+4Yq97zuZNye8x0ztjWejLjxu/+pf36k606G/N4Ztf8mLpr2obO2es/FZttpy9zbbK/XNgxoH7dsJvIZw07kCYadyBMMO5EnGHYiTzDsRJ5g2Ik8Ufpx9vjV7gvk7DXMoxi6folZX3LPBruedI+LnlndbbZNwB4vrg0ZT66P2WPhKeMxDPtv/uZws1nPhlzDq5+cZdbTxnhz99EGs23C+PzAZFj7EAxnQrZsHrbnu8djdm5Sr9tz7Wdud392omat/bdo4Tg7ETHsRL5g2Ik8wbATeYJhJ/IEw07kCYadyBOh4+wi0gzgSQBNABRAq6o+LCL3AvhbAL3BRe9R1bXWdUWdz16p5AJ7TfrhOXVmveaQPTd68GS7fcOH7nXpYyP2mvO5P+8w6/TVYo2zT2aTiAyAO1V1o4gkAbwrIi8HtYdU9V8L1VEiKp7J7M/eBaArOD0oIjsAzCt2x4iosL7Ua3YRmQ/gPADrg7PuEJHNIrJaRGY42qwSkXYRaU/DfrpKRMUz6bCLyFQAvwPwE1UdAPBLAKcBWISxI/8DE7VT1VZVbVHVlgTs/dSIqHgmFXYRSWAs6L9S1WcAQFW7VTWrqjkAjwJYXLxuElFUoWEXEQHwOIAdqvrguPPnjrvYdQC2Fr57RFQok3k3/hIANwPYIiKbgvPuAbBCRBZhbDiuA8BtRejfV4Ju2GLW7cmS4Rrezr9ttMWY6XgymXfj3wQmXFzcHFMnosrCT9AReYJhJ/IEw07kCYadyBMMO5EnGHYiTzDsRJ5g2Ik8wbATeYJhJ/IEw07kCYadyBMMO5EnGHYiT5R0y2YR6QWwd9xZswAcLFkHvpxK7Vul9gtg3/JVyL6drKqzJyqUNOxfuHGRdlVtKVsHDJXat0rtF8C+5atUfePTeCJPMOxEnih32FvLfPuWSu1bpfYLYN/yVZK+lfU1OxGVTrmP7ERUIgw7kSfKEnYRWSoiO0XkAxG5uxx9cBGRDhHZIiKbRKS9zH1ZLSI9IrJ13HmNIvKyiOwKvk+4x16Z+naviHQG990mEVlWpr41i8hrIrJdRLaJyI+D88t63xn9Ksn9VvLX7CISB/A+gKsA7AewAcAKVd1e0o44iEgHgBZVLfsHMETkMgBHADypqmcH590PoE9V7wv+Uc5Q1bsqpG/3AjhS7m28g92K5o7fZhzAtQBuRRnvO6NfN6AE91s5juyLAXygqrtVdRTArwEsL0M/Kp6qrgPQd8zZywGsCU6vwdgfS8k5+lYRVLVLVTcGpwcBfLrNeFnvO6NfJVGOsM8DsG/cz/tRWfu9K4CXRORdEVlV7s5MoElVu4LTBwA0lbMzEwjdxruUjtlmvGLuu3y2P4+Kb9B90aWqej6AawDcHjxdrUg69hqsksZOJ7WNd6lMsM34Z8p53+W7/XlU5Qh7J4DmcT+fFJxXEVS1M/jeA+BZVN5W1N2f7qAbfO8pc38+U0nbeE+0zTgq4L4r5/bn5Qj7BgALROQUEakGcCOA58vQjy8QkfrgjROISD2Aq1F5W1E/D+CW4PQtAJ4rY18+p1K28XZtM44y33dl3/5cVUv+BWAZxt6R/xDAz8rRB0e/TgXw5+BrW7n7BuBpjD2tS2PsvY2VAGYCaAOwC8ArABorqG//A2ALgM0YC9bcMvXtUow9Rd8MYFPwtazc953Rr5Lcb/y4LJEn+AYdkScYdiJPMOxEnmDYiTzBsBN5gmEn8gTDTuSJ/wcK8iUIg3ozJAAAAABJRU5ErkJggg==%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>아닌데요?! 칼라인데요?! -&gt; 흑백이다. 그냥 밝을수록 노란색, 어두울수록 남색으로 표현한것 뿐임 (colormap이 viridis일 뿐임)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 일반적으로 분석할 이미지는 칼라를 의미하는 채널도 포함할테니 아래와 같이 자료형을 정리하는게 일반적으로 이미지 자료를 분석하는 정석적인 처리방법이다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 그런데 모형에 넣고 돌릴려면 다시 차원을 펼쳐야 하지 않을까?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 안 펼치고 할 수 없나? $\to$ 아래의 <code>flatten</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">XX</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([60000, 28, 28, 1]), TensorShape([10000, 28, 28, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>keras에서 이미지자료는 (관측치수,픽셀,픽셀,채널)과 같은 형식을 가진다. </li>
<li>예를들어 256*256 size인 칼라이미지(채널수=3)가 10개 있다면 X.shape은 (10,256,256,3)이다. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="X의-차원이-(관측치수,픽셀,픽셀,채널)일-경우-DNN-쓰기">
<a class="anchor" href="#X%EC%9D%98-%EC%B0%A8%EC%9B%90%EC%9D%B4-(%EA%B4%80%EC%B8%A1%EC%B9%98%EC%88%98,%ED%94%BD%EC%85%80,%ED%94%BD%EC%85%80,%EC%B1%84%EB%84%90)%EC%9D%BC-%EA%B2%BD%EC%9A%B0-DNN-%EC%93%B0%EA%B8%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>X의 차원이 (관측치수,픽셀,픽셀,채널)일 경우 DNN 쓰기<a class="anchor-link" href="#X%EC%9D%98-%EC%B0%A8%EC%9B%90%EC%9D%B4-(%EA%B4%80%EC%B8%A1%EC%B9%98%EC%88%98,%ED%94%BD%EC%85%80,%ED%94%BD%EC%85%80,%EC%B1%84%EB%84%90)%EC%9D%BC-%EA%B2%BD%EC%9A%B0-DNN-%EC%93%B0%EA%B8%B0"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(예제1)-X--&gt;-Dense(30,relu)--&gt;-Dense(10,softmax):=&gt;-y">
<a class="anchor" href="#(%EC%98%88%EC%A0%9C1)-X--&gt;-Dense(30,relu)--&gt;-Dense(10,softmax):=&gt;-y" aria-hidden="true"><span class="octicon octicon-link"></span></a>(예제1) X -&gt; Dense(30,relu) -&gt; Dense(10,softmax):=&gt; y<a class="anchor-link" href="#(%EC%98%88%EC%A0%9C1)-X--&gt;-Dense(30,relu)--&gt;-Dense(10,softmax):=&gt;-y"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 이러한 아키텍처를 돌리기 위해서는 X의 shape을 미리 바꿔야 했었다. 혹시 바꾸지 않는 방법도 있을까?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> tf.keras.layers.Flatten()</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flttn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flttn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.layers.core.flatten.Flatten at 0x7f95ddef6f50&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>type: flatten &lt;- 머 어쩌란거야..</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">flttn</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">{</span><span class="s1">'__call__'</span><span class="p">}</span>  <span class="c1">#set으로 집합, &amp;으로 교집합</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'__call__'}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>call이 있음 -&gt; 써보자</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">flttn</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([60000, 28, 28, 1]),
 &lt;tf.Tensor: shape=(60000, 784), dtype=float32, numpy=
 array([[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flttn</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(60000, 784), dtype=float32, numpy=
array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">784</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(60000, 784), dtype=float64, numpy=
array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>펴진다? <strong>즉 X.reshape(-1,784)와 같은 기능!</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 근데 이거 <strong>레이어다?</strong> <strong>즉 네트워크에 add 할 수 있다는 의미!</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 그렇다면 아래와 같이 예제를 풀어도 괜찮겠다.</p>
<blockquote>
<p>metrics=['accuracy','Recall']이렇게 2개도 가능하지!</p>
</blockquote>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 19s 10ms/step - loss: 2.5291 - accuracy: 0.4090
Epoch 2/5
1875/1875 [==============================] - 19s 10ms/step - loss: 1.1649 - accuracy: 0.5447
Epoch 3/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.9883 - accuracy: 0.5980
Epoch 4/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.9369 - accuracy: 0.6159
Epoch 5/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.8640 - accuracy: 0.6451
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddfcab00&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 관찰</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;keras.layers.core.flatten.Flatten at 0x7f95de182500&gt;,
 &lt;keras.layers.core.dense.Dense at 0x7f95ddef64a0&gt;,
 &lt;keras.layers.core.dense.Dense at 0x7f95de1669e0&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">X</span><span class="p">)</span> <span class="c1"># 레이어를 통과하는 순간 전처리!</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(60000, 784), dtype=float32, numpy=
array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">X</span><span class="p">))</span> <span class="c1"># 출력이 30이니까~ + 렐루를 거쳐서 0또는 양수인 모습!</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(60000, 30), dtype=float32, numpy=
array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">net1</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">X</span><span class="p">)))</span> <span class="c1"># 최종출력 10차원, 각각은 확률을 의미하게 된다. </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(60000, 10), dtype=float32, numpy=
array([[0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ..., 1.0529677e-04,
        0.0000000e+00, 9.9789065e-01],
       [1.3276602e-01, 1.8076894e-03, 2.3582792e-01, ..., 2.4486837e-04,
        2.6956499e-02, 7.0856529e-04],
       [4.4846085e-01, 2.3028793e-02, 1.6645418e-03, ..., 5.9820746e-24,
        8.2463684e-04, 7.2763857e-14],
       ...,
       [4.6494240e-01, 6.1101977e-02, 2.1869731e-05, ..., 3.4271203e-38,
        3.0596584e-05, 2.7073474e-21],
       [1.7478003e-01, 2.7406293e-03, 1.6104330e-01, ..., 2.3228845e-06,
        2.1515733e-02, 7.0975919e-05],
       [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ..., 4.1029420e-09,
        1.7662206e-26, 2.8550520e-10]], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (참고) metrics=['accuracy'] 대신에 이렇게 해도된다~</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">CategoricalAccuracy</span><span class="p">()])</span>
<span class="n">net1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 19s 10ms/step - loss: 2.5211 - categorical_accuracy: 0.4120
Epoch 2/5
1875/1875 [==============================] - 19s 10ms/step - loss: 1.1434 - categorical_accuracy: 0.5489
Epoch 3/5
1875/1875 [==============================] - 19s 10ms/step - loss: 1.0170 - categorical_accuracy: 0.5913
Epoch 4/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.9324 - categorical_accuracy: 0.6153
Epoch 5/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.8899 - categorical_accuracy: 0.6336
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddecbfa0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">id</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">CategoricalAccuracy</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">CategoricalAccuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(93847881526656, 93847881526656)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>주소가 똑같네요, 이게 무슨말인지 알죠?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 주의사항: tf.metrics.Accuracy() 말고 tf.metrics.CategoricalAccuracy() 를 써야함</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> (참고2) 메트릭을 추가할수도 있다</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">CategoricalAccuracy</span><span class="p">(),</span><span class="n">tf</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">()])</span>
<span class="n">net1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 18s 10ms/step - loss: 2.5215 - categorical_accuracy: 0.4158 - recall: 0.3054
Epoch 2/5
1875/1875 [==============================] - 18s 10ms/step - loss: 1.1357 - categorical_accuracy: 0.5554 - recall: 0.4457
Epoch 3/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.9923 - categorical_accuracy: 0.5962 - recall: 0.4853
Epoch 4/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.9309 - categorical_accuracy: 0.6177 - recall: 0.5026
Epoch 5/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.8677 - categorical_accuracy: 0.6448 - recall: 0.4892
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddec98a0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 리콜을 추가하면 test set의 성능평가에도 리콜을 볼 수 있다.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 13ms/step - loss: 0.8814 - categorical_accuracy: 0.6443 - recall: 0.5028
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.8814178705215454, 0.6442999839782715, 0.5027999877929688]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(예제2)-X--&gt;-Dense(500,relu)--&gt;-Dense(500,relu)--&gt;-Dense(10,softmax):=&gt;y">
<a class="anchor" href="#(%EC%98%88%EC%A0%9C2)-X--&gt;-Dense(500,relu)--&gt;-Dense(500,relu)--&gt;-Dense(10,softmax):=&gt;y" aria-hidden="true"><span class="octicon octicon-link"></span></a>(예제2) X -&gt; Dense(500,relu) -&gt; Dense(500,relu) -&gt; Dense(10,softmax):=&gt;y<a class="anchor-link" href="#(%EC%98%88%EC%A0%9C2)-X--&gt;-Dense(500,relu)--&gt;-Dense(500,relu)--&gt;-Dense(10,softmax):=&gt;y"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 다른모형으로도 적합시켜보자.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/5
1875/1875 [==============================] - 18s 10ms/step - loss: 2.2255 - accuracy: 0.7517
Epoch 2/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.6271 - accuracy: 0.7969
Epoch 3/5
1875/1875 [==============================] - 19s 10ms/step - loss: 0.5380 - accuracy: 0.8176
Epoch 4/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4652 - accuracy: 0.8351
Epoch 5/5
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4367 - accuracy: 0.8450
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddb13d90&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 12ms/step - loss: 0.4871 - accuracy: 0.8318
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95ddb8d960&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">net2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_5"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_3 (Flatten)         (None, 784)               0         
                                                                 
 dense_11 (Dense)            (None, 30)                23550     
                                                                 
 dense_12 (Dense)            (None, 10)                310       
                                                                 
=================================================================
Total params: 23,860
Trainable params: 23,860
Non-trainable params: 0
_________________________________________________________________
Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_5 (Flatten)         (None, 784)               0         
                                                                 
 dense_16 (Dense)            (None, 500)               392500    
                                                                 
 dense_17 (Dense)            (None, 500)               250500    
                                                                 
 dense_18 (Dense)            (None, 10)                5010      
                                                                 
=================================================================
Total params: 648,010
Trainable params: 648,010
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 좀 더 돌려보자.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net2</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
1875/1875 [==============================] - 18s 10ms/step - loss: 2.2612 - accuracy: 0.7479
Epoch 2/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.6076 - accuracy: 0.7995
Epoch 3/10
1875/1875 [==============================] - 19s 10ms/step - loss: 0.5334 - accuracy: 0.8198
Epoch 4/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4587 - accuracy: 0.8380
Epoch 5/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4279 - accuracy: 0.8475
Epoch 6/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.4102 - accuracy: 0.8527
Epoch 7/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.3999 - accuracy: 0.8605
Epoch 8/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.3851 - accuracy: 0.8611
Epoch 9/10
1875/1875 [==============================] - 18s 10ms/step - loss: 0.3825 - accuracy: 0.8623
Epoch 10/10
1875/1875 [==============================] - 19s 10ms/step - loss: 0.3739 - accuracy: 0.8662
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95776413f0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 12ms/step - loss: 0.4468 - accuracy: 0.8489
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f957770bb80&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 이 이상은 비효율적인듯..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="더-좋은-모형을-만들고-싶은데..">
<a class="anchor" href="#%EB%8D%94-%EC%A2%8B%EC%9D%80-%EB%AA%A8%ED%98%95%EC%9D%84-%EB%A7%8C%EB%93%A4%EA%B3%A0-%EC%8B%B6%EC%9D%80%EB%8D%B0.." aria-hidden="true"><span class="octicon octicon-link"></span></a>더 좋은 모형을 만들고 싶은데..<a class="anchor-link" href="#%EB%8D%94-%EC%A2%8B%EC%9D%80-%EB%AA%A8%ED%98%95%EC%9D%84-%EB%A7%8C%EB%93%A4%EA%B3%A0-%EC%8B%B6%EC%9D%80%EB%8D%B0.."> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(예제3)-아주-복잡한-DNN">
<a class="anchor" href="#(%EC%98%88%EC%A0%9C3)-%EC%95%84%EC%A3%BC-%EB%B3%B5%EC%9E%A1%ED%95%9C-DNN" aria-hidden="true"><span class="octicon octicon-link"></span></a>(예제3) 아주 복잡한 DNN<a class="anchor-link" href="#(%EC%98%88%EC%A0%9C3)-%EC%95%84%EC%A3%BC-%EB%B3%B5%EC%9E%A1%ED%95%9C-DNN"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 무지성: 아 몰라 딥러닝이 해주겠지</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">43052</span><span class="p">)</span>
<span class="n">net3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
<span class="n">net3</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
<span class="n">net3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
1875/1875 [==============================] - 16s 8ms/step - loss: 0.9836 - accuracy: 0.7942
Epoch 2/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.4495 - accuracy: 0.8395
Epoch 3/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.4185 - accuracy: 0.8528
Epoch 4/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.3930 - accuracy: 0.8619
Epoch 5/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.3736 - accuracy: 0.8686
Epoch 6/10
1875/1875 [==============================] - 17s 9ms/step - loss: 0.3683 - accuracy: 0.8718
Epoch 7/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.3445 - accuracy: 0.8774
Epoch 8/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.3325 - accuracy: 0.8816
Epoch 9/10
1875/1875 [==============================] - 16s 9ms/step - loss: 0.3288 - accuracy: 0.8829
Epoch 10/10
1875/1875 [==============================] - 16s 8ms/step - loss: 0.3164 - accuracy: 0.8867
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x7f95775ca0e0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net3</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>313/313 [==============================] - 4s 12ms/step - loss: 0.3723 - accuracy: 0.8702
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[0.372260183095932, 0.870199978351593]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_7"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_5 (Flatten)         (None, 784)               0         
                                                                 
 dense_16 (Dense)            (None, 500)               392500    
                                                                 
 dense_17 (Dense)            (None, 500)               250500    
                                                                 
 dense_18 (Dense)            (None, 10)                5010      
                                                                 
=================================================================
Total params: 648,010
Trainable params: 648,010
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_8"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_6 (Flatten)         (None, 784)               0         
                                                                 
 dense_19 (Dense)            (None, 500)               392500    
                                                                 
 dense_20 (Dense)            (None, 500)               250500    
                                                                 
 dense_21 (Dense)            (None, 500)               250500    
                                                                 
 dense_22 (Dense)            (None, 500)               250500    
                                                                 
 dense_23 (Dense)            (None, 500)               250500    
                                                                 
 dense_24 (Dense)            (None, 10)                5010      
                                                                 
=================================================================
Total params: 1,399,510
Trainable params: 1,399,510
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 파라메터 증가대비 그닥..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 왠지 DNN계열로는 한계가 있어보인다.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h6 id="$\to$-여기까지-05/09-수업내용">
<a class="anchor" href="#%24%5Cto%24-%EC%97%AC%EA%B8%B0%EA%B9%8C%EC%A7%80-05/09-%EC%88%98%EC%97%85%EB%82%B4%EC%9A%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>$\to$ 여기까지 05/09 수업내용<a class="anchor-link" href="#%24%5Cto%24-%EC%97%AC%EA%B8%B0%EA%B9%8C%EC%A7%80-05/09-%EC%88%98%EC%97%85%EB%82%B4%EC%9A%A9"> </a>
</h6>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="발상의-전환">
<a class="anchor" href="#%EB%B0%9C%EC%83%81%EC%9D%98-%EC%A0%84%ED%99%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>발상의 전환<a class="anchor-link" href="#%EB%B0%9C%EC%83%81%EC%9D%98-%EC%A0%84%ED%99%98"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> Flattne 레이어를 보면서 느낀점: 생각해보니까 $X \to \hat{y}$를 만드는 과정이 꼭 Full Linear Transform(Dense layer) + Activation(Activation layer)일 필요는 없잖아?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 뭐가있지?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['AbstractRNNCell',
 'Activation',
 'ActivityRegularization',
 'Add',
 'AdditiveAttention',
 'AlphaDropout',
 'Attention',
 'Average',
 'AveragePooling1D',
 'AveragePooling2D',
 'AveragePooling3D',
 'AvgPool1D',
 'AvgPool2D',
 'AvgPool3D',
 'BatchNormalization',
 'Bidirectional',
 'CategoryEncoding',
 'CenterCrop',
 'Concatenate',
 'Conv1D',
 'Conv1DTranspose',
 'Conv2D',
 'Conv2DTranspose',
 'Conv3D',
 'Conv3DTranspose',
 'ConvLSTM1D',
 'ConvLSTM2D',
 'ConvLSTM3D',
 'Convolution1D',
 'Convolution1DTranspose',
 'Convolution2D',
 'Convolution2DTranspose',
 'Convolution3D',
 'Convolution3DTranspose',
 'Cropping1D',
 'Cropping2D',
 'Cropping3D',
 'Dense',
 'DenseFeatures',
 'DepthwiseConv1D',
 'DepthwiseConv2D',
 'Discretization',
 'Dot',
 'Dropout',
 'ELU',
 'Embedding',
 'Flatten',
 'GRU',
 'GRUCell',
 'GaussianDropout',
 'GaussianNoise',
 'GlobalAveragePooling1D',
 'GlobalAveragePooling2D',
 'GlobalAveragePooling3D',
 'GlobalAvgPool1D',
 'GlobalAvgPool2D',
 'GlobalAvgPool3D',
 'GlobalMaxPool1D',
 'GlobalMaxPool2D',
 'GlobalMaxPool3D',
 'GlobalMaxPooling1D',
 'GlobalMaxPooling2D',
 'GlobalMaxPooling3D',
 'Hashing',
 'Input',
 'InputLayer',
 'InputSpec',
 'IntegerLookup',
 'LSTM',
 'LSTMCell',
 'Lambda',
 'Layer',
 'LayerNormalization',
 'LeakyReLU',
 'LocallyConnected1D',
 'LocallyConnected2D',
 'Masking',
 'MaxPool1D',
 'MaxPool2D',
 'MaxPool3D',
 'MaxPooling1D',
 'MaxPooling2D',
 'MaxPooling3D',
 'Maximum',
 'Minimum',
 'MultiHeadAttention',
 'Multiply',
 'Normalization',
 'PReLU',
 'Permute',
 'RNN',
 'RandomContrast',
 'RandomCrop',
 'RandomFlip',
 'RandomHeight',
 'RandomRotation',
 'RandomTranslation',
 'RandomWidth',
 'RandomZoom',
 'ReLU',
 'RepeatVector',
 'Rescaling',
 'Reshape',
 'Resizing',
 'SeparableConv1D',
 'SeparableConv2D',
 'SeparableConvolution1D',
 'SeparableConvolution2D',
 'SimpleRNN',
 'SimpleRNNCell',
 'Softmax',
 'SpatialDropout1D',
 'SpatialDropout2D',
 'SpatialDropout3D',
 'StackedRNNCells',
 'StringLookup',
 'Subtract',
 'TextVectorization',
 'ThresholdedReLU',
 'TimeDistributed',
 'UpSampling1D',
 'UpSampling2D',
 'UpSampling3D',
 'Wrapper',
 'ZeroPadding1D',
 'ZeroPadding2D',
 'ZeroPadding3D',
 '__builtins__',
 '__cached__',
 '__doc__',
 '__file__',
 '__loader__',
 '__name__',
 '__package__',
 '__path__',
 '__spec__',
 '_sys',
 'add',
 'average',
 'concatenate',
 'deserialize',
 'dot',
 'experimental',
 'maximum',
 'minimum',
 'multiply',
 'serialize',
 'subtract']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 엄청많아..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 우리는 이중에서 2D conv, max pooling 에 관심이 있다! (이번수업은 max pooling 정도만)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="MaxPooling2D,-MaxPool2D">
<a class="anchor" href="#MaxPooling2D,-MaxPool2D" aria-hidden="true"><span class="octicon octicon-link"></span></a>MaxPooling2D, MaxPool2D<a class="anchor-link" href="#MaxPooling2D,-MaxPool2D"> </a>
</h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">id</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">),</span> <span class="nb">id</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(93847880576320, 93847880576320)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 테스트1: (2,2) 이미지</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">()</span> <span class="c1"># pool size의 디폴트는 (2,2)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">XXX</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">XXX</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 2, 2, 1), dtype=int64, numpy=
array([[[[0],
         [1]],

        [[2],
         [3]]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">XXX</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 채널때문에 살짝 헷갈리지만 실제로는 이렇게 생긴 이미지! </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[0, 1],
        [2, 3]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp</span><span class="p">(</span><span class="n">XXX</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 1, 1, 1), dtype=int64, numpy=array([[[[3]]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 테스트2: (4,4) 이미지로 변경</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">()</span> <span class="c1"># pool size의 디폴트는 (2,2)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">XXX</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">XXX</span><span class="p">,</span><span class="n">XXX</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Tensor: shape=(1, 4, 4, 1), dtype=int64, numpy=
 array([[[[ 0],
          [ 1],
          [ 2],
          [ 3]],
 
         [[ 4],
          [ 5],
          [ 6],
          [ 7]],
 
         [[ 8],
          [ 9],
          [10],
          [11]],
 
         [[12],
          [13],
          [14],
          [15]]]])&gt;,
 &lt;tf.Tensor: shape=(1, 4, 4), dtype=int64, numpy=
 array([[[ 0,  1,  2,  3],
         [ 4,  5,  6,  7],
         [ 8,  9, 10, 11],
         [12, 13, 14, 15]]])&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp</span><span class="p">(</span><span class="n">XXX</span><span class="p">),</span><span class="n">mp</span><span class="p">(</span><span class="n">XXX</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Tensor: shape=(1, 2, 2, 1), dtype=int64, numpy=
 array([[[[ 5],
          [ 7]],
 
         [[13],
          [15]]]])&gt;,
 &lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
 array([[[ 5,  7],
         [13, 15]]])&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 테스트3: (6,6) 이미지</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">XXX</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="mi">6</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">XXX</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 6, 6), dtype=int64, numpy=
array([[[ 0,  1,  2,  3,  4,  5],
        [ 6,  7,  8,  9, 10, 11],
        [12, 13, 14, 15, 16, 17],
        [18, 19, 20, 21, 22, 23],
        [24, 25, 26, 27, 28, 29],
        [30, 31, 32, 33, 34, 35]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 테스트4: (6,6) 이미지 + pool_size=(3, 3)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp</span><span class="p">(</span><span class="n">XXX</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># 왜 (2,2)씩...? </span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 3, 3), dtype=int64, numpy=
array([[[ 7,  9, 11],
        [19, 21, 23],
        [31, 33, 35]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mp3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">mp3</span><span class="p">(</span><span class="n">XXX</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[14, 17],
        [32, 35]]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="kimha02/ham"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/ham/bigdata/2022/05/08/_05_09_(10%EC%A3%BC%EC%B0%A8)_5%EC%9B%949%EC%9D%BC_dr.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/ham/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/ham/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/ham/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/kimha02" target="_blank" title="kimha02"><svg class="svg-icon grey"><use xlink:href="/ham/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
